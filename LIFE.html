<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: black;
            color: white;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        #game-container {
            text-align: center;
        }

        .title {
            font-size: 180px;
            font-weight: bold;
            background: linear-gradient(180deg, #FFD700 0%, #1E90FF 100%);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            animation: pulse 2s infinite ease-in-out;
            margin: 0;
            padding: 0;
        }

        .start-button {
            background: transparent;
            border: 1px solid white;
            color: white;
            padding: 15px 40px;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 50px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 1s forwards;
        }

        .start-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .opening-text {
            font-size: 36px;
            opacity: 0;
            transform: translateY(20px);
            margin: 10px 0;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            white-space: nowrap;
            color: white;
            text-align: center;
            width: 100%;
        }

        /* 骰子样式 */
        .dice-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            opacity: 0;
            animation: fadeIn 1s ease-in-out forwards;
            perspective: 1000px;
        }

        .dice {
            width: 100px;
            height: 100px;
            position: relative;
            transform-style: preserve-3d;
            cursor: pointer;
            transition: transform 0.5s ease;
            margin: 50px;
            transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg);
        }

        .dice-face {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: bold;
            color: black;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 15px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        /* 骰子面的点 */
        .dot {
            display: block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #333;
            position: absolute;
            box-shadow: inset 0 0 2px rgba(0, 0, 0, 0.5);
        }

        /* 骰子1面 */
        .face-1 {
            transform: translateZ(50px);
        }
        .face-1 .dot {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        /* 骰子2面 */
        .face-2 {
            transform: rotateY(180deg) translateZ(50px);
        }
        .face-2 .dot:nth-child(1) {
            top: 25%;
            left: 25%;
        }
        .face-2 .dot:nth-child(2) {
            bottom: 25%;
            right: 25%;
        }

        /* 骰子3面 */
        .face-3 {
            transform: rotateY(-90deg) translateZ(50px);
        }
        .face-3 .dot:nth-child(1) {
            top: 25%;
            left: 25%;
        }
        .face-3 .dot:nth-child(2) {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .face-3 .dot:nth-child(3) {
            bottom: 25%;
            right: 25%;
        }

        /* 骰子4面 */
        .face-4 {
            transform: rotateY(90deg) translateZ(50px);
        }
        .face-4 .dot:nth-child(1) {
            top: 25%;
            left: 25%;
        }
        .face-4 .dot:nth-child(2) {
            top: 25%;
            right: 25%;
        }
        .face-4 .dot:nth-child(3) {
            bottom: 25%;
            left: 25%;
        }
        .face-4 .dot:nth-child(4) {
            bottom: 25%;
            right: 25%;
        }

        /* 骰子5面 */
        .face-5 {
            transform: rotateX(90deg) translateZ(50px);
        }
        .face-5 .dot:nth-child(1) {
            top: 25%;
            left: 25%;
        }
        .face-5 .dot:nth-child(2) {
            top: 25%;
            right: 25%;
        }
        .face-5 .dot:nth-child(3) {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .face-5 .dot:nth-child(4) {
            bottom: 25%;
            left: 25%;
        }
        .face-5 .dot:nth-child(5) {
            bottom: 25%;
            right: 25%;
        }

        /* 骰子6面 */
        .face-6 {
            transform: rotateX(-90deg) translateZ(50px);
        }
        .face-6 .dot:nth-child(1) {
            top: 20%;
            left: 20%;
            transform: translate(-50%, -50%);
        }
        .face-6 .dot:nth-child(2) {
            top: 20%;
            right: 20%;
            transform: translate(50%, -50%);
        }
        .face-6 .dot:nth-child(3) {
            top: 50%;
            left: 20%;
            transform: translate(-50%, -50%);
        }
        .face-6 .dot:nth-child(4) {
            top: 50%;
            right: 20%;
            transform: translate(50%, -50%);
        }
        .face-6 .dot:nth-child(5) {
            bottom: 20%;
            left: 20%;
            transform: translate(-50%, 50%);
        }
        .face-6 .dot:nth-child(6) {
            bottom: 20%;
            right: 20%;
            transform: translate(50%, 50%);
        }

        .click-instruction {
            font-size: 24px;
            margin-top: 20px;
            color: white;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .dice-rolling {
            animation: rolling 2s ease-out;
        }

        /* 角色信息样式 */
        .character-screen {
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background-color: rgba(0, 0, 0, 0.8);
            border: 1px solid white;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
            text-align: left;
            opacity: 0;
            animation: fadeIn 1s ease-in-out forwards;
        }

        .character-description {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .health-bar-container {
            margin-bottom: 15px;
        }

        .health-bar-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .health-bar {
            height: 20px;
            width: 100%;
            background-color: #444;
            border-radius: 10px;
            overflow: hidden;
        }

        .health-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 1s ease-in-out;
        }

        .physical-health {
            background-color: #9C27B0;  /* 紫色 */
        }

        .mental-health {
            background-color: #F44336;  /* 红色 */
        }

        .continue-button {
            background: transparent;
            border: 1px solid white;
            color: white;
            padding: 12px 30px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 30px;
            display: block;
            width: 200px;
            margin-left: auto;
            margin-right: auto;
        }

        .continue-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        @keyframes rolling {
            0% { 
                transform: rotateX(0deg) rotateY(0deg) rotateZ(0deg); 
            }
            20% { 
                transform: rotateX(180deg) rotateY(240deg) rotateZ(120deg); 
            }
            40% { 
                transform: rotateX(360deg) rotateY(120deg) rotateZ(240deg); 
            }
            60% { 
                transform: rotateX(540deg) rotateY(360deg) rotateZ(360deg); 
            }
            80% { 
                transform: rotateX(720deg) rotateY(480deg) rotateZ(480deg); 
            }
            100% { 
                transform: var(--final-rotation); 
            }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translate(-50%, -30%);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -70%);
            }
        }

        .hidden {
            display: none !important;
        }

        /* 报纸样式 */
        .newspaper-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
        }

        .newspaper {
            width: 595px; /* A4纸宽度 */
            height: 842px; /* A4纸高度 */
            background: linear-gradient(to bottom, #f4e4bc, #e6d5a7);
            border: 1px solid #d4c59f;
            padding: 40px;
            transform-origin: center;
            transform: rotate(5deg) scale(0.8) translate(1000px, -1000px);
            animation: flyIn 2s cubic-bezier(0.23, 1, 0.32, 1) forwards;
            box-shadow: 
                0 0 20px rgba(0, 0, 0, 0.2),
                2px 3px 5px rgba(0, 0, 0, 0.1),
                -2px 3px 5px rgba(0, 0, 0, 0.1),
                inset 0 0 40px rgba(139, 109, 30, 0.1); /* 内阴影模拟做旧效果 */
            color: #333;
            font-family: "Times New Roman", Times, serif;
            overflow-y: auto;
            position: relative;
        }

        .newspaper::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to right, #d4c59f 0%, transparent 20%, transparent 80%, #d4c59f 100%);
            pointer-events: none;
        }

        .newspaper-title {
            font-size: 36px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            position: relative;
            white-space: pre-line;
            line-height: 1.4;
            border-bottom: double 6px #333;
        }

        .newspaper-content {
            column-count: 3;
            column-gap: 30px;
            text-align: justify;
            line-height: 1.6;
            margin-bottom: 20px;
            height: calc(100% - 150px);
            column-fill: auto;
            position: relative;
        }

        .highlight {
            font-weight: bold;
            color: #000;
            background: #ffeb3b;
            padding: 0 5px;
            margin: 0 2px;
            display: inline-block;
            white-space: nowrap;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .blur-text {
            color: transparent;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
            display: inline;
            word-break: break-all;
            line-height: 1.8;
        }

        @keyframes flyIn {
            0% {
                transform: rotate(45deg) scale(0.1) translate(1000px, -1000px);
                opacity: 0;
            }
            50% {
                transform: rotate(25deg) scale(0.9) translate(100px, -100px);
                opacity: 0.8;
            }
            75% {
                transform: rotate(-5deg) scale(0.85) translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: rotate(5deg) scale(0.8) translate(0, 0);
                opacity: 1;
            }
        }

        .visible {
            opacity: 1 !important;
            pointer-events: auto !important;
        }

        /* 游戏主界面样式 */
        .game-main-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: black;
            display: none;
        }

        .game-main-screen.visible {
            display: block;
        }

        /* 状态栏样式 */
        .status-bars {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 250px;
        }

        .status-bar-container {
            display: flex;
            flex-direction: column;
            gap: 8px;  /* 统一所有状态栏之间的间距 */
            margin-bottom: 8px;
        }

        .status-bar-label {
            display: flex;
            justify-content: space-between;
            color: white;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .status-bar {
            height: 15px;
            background-color: #444;
            border-radius: 7px;
            overflow: hidden;
        }

        .status-bar-fill {
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 7px;
        }

        .wealth-bar {
            background-color: #FFD700;
            display: block !important;  /* 确保进度条显示 */
        }

        /* 日历样式 */
        .calendar {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            color: white;
            font-size: 12px;
        }

        .calendar-header {
            text-align: center;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }

        .calendar-day {
            text-align: center;
            padding: 2px;
        }

        .calendar-day.current {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
        }

        .weekday {
            font-weight: bold;
            color: #888;
        }

        /* 现金选项样式 */
        .cash-options {
            position: fixed;
            bottom: 20px;
            left: 40px;
            color: white;
        }

        .cash-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #ffffff;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .cash-title span {
            display: block;
            line-height: 1.2;
        }

        .cash-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }

        .cash-button {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            opacity: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;  /* 添加emoji字体大小 */
        }

        .cash-button.used {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .cash-button:not(.used):hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .cash-button:hover .tooltip {
            opacity: 1;
        }

        .tooltip {
            position: absolute;
            left: 50px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(30, 144, 255, 0.9);
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            color: white;
            z-index: 1000;
            border: 1px solid #1E90FF;
            box-shadow: 0 0 10px rgba(30, 144, 255, 0.2);
        }

        .tooltip.multiline {
            white-space: pre-line;
            min-width: 250px;
        }

        /* 更新硬币图标样式 */
        .coin-icon {
            width: 24px;
            height: 24px;
            fill: #1E90FF;
        }

        .phone-icon {
            width: 14px;
            height: 20px;
            position: relative;
            display: inline-block;
            border: 2px solid #1E90FF;
            border-radius: 3px;
            margin-top: -2px;
        }

        .phone-icon::before {
            content: '';
            position: absolute;
            width: 4px;
            height: 4px;
            border: 1px solid #1E90FF;
            border-radius: 50%;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
        }

        .phone-icon::after {
            content: '';
            position: absolute;
            width: 2px;
            height: 2px;
            background: #1E90FF;
            border-radius: 50%;
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
        }

        .bank-icon {
            width: 24px;
            height: 24px;
            fill: #1E90FF;
        }

        /* LIFE logo样式 */
        .life-logo {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-family: 'Orbitron', sans-serif;
            font-size: 36px;
            color: white;
            letter-spacing: 2px;
        }

        /* 添加过渡文字的容器样式 */
        .transition-sequence {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: black;
            z-index: 1000;
        }

        /* 添加说明框样式 */
        .info-box {
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background-color: #90EE90;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(144, 238, 144, 0.1);
            text-align: left;
            opacity: 0;
            animation: fadeIn 1s ease-in-out forwards;
            color: black;
            font-size: 22px;
            line-height: 1.6;
            position: relative;
            padding-bottom: 120px;
        }

        .info-continue-button {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            background: transparent;
            border: 1px solid black;
            color: black;
            padding: 12px 30px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 200px;
        }

        .info-continue-button:hover {
            transform: translateX(-50%) scale(1.05);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }

        .info-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: black;
            z-index: 1000;
        }

        .company-selection-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: black;
            z-index: 1000;
        }

        .company-prompt {
            font-size: 36px;
            color: white;
            margin-bottom: 50px;
            text-align: center;
        }

        .company-buttons {
            display: flex;
            gap: 60px;
            margin-bottom: 50px;
        }

        .company-button {
            padding: 15px 40px;
            font-size: 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .meituan-button {
            background-color: #FFC300;
            color: white;
        }

        .elema-button {
            background-color: #1E90FF;
            color: white;
        }

        .company-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .salary-info {
            font-size: 24px;
            color: white;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            margin-bottom: 30px;
            width: 400px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.8;
        }

        .weekly-pay {
            margin-top: 30px;
            font-size: 28px;
            text-align: center;
        }

        .pay-line {
            width: 150px;
            height: 2px;
            margin: 10px auto;
        }

        .final-pay {
            font-size: 36px;
            font-weight: bold;
            text-align: center;
        }

        .company-continue-button {
            background: transparent;
            border: 1px solid white;
            color: white;
            padding: 12px 30px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 200px;
            opacity: 0;
            pointer-events: none;
            margin: 0 auto;
            display: block;
        }

        .company-continue-button.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .company-continue-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }

        .meituan-color {
            color: #FFC300;
        }

        .elema-color {
            color: #1E90FF;
        }

        .day-screen {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 600px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .day-number {
            font-size: 120px;
            font-family: 'Orbitron', sans-serif;
            color: white;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.7);
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.5s ease;
        }

        .event-screen {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 800px;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .event-screen.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .event-container {
            width: 100%;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .event-text {
            font-size: 24px;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: center;
            color: white;
        }

        .event-question {
            font-size: 32px;
            line-height: 1.6;
            margin: 30px 0;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .event-option {
            background: transparent;
            border: 1px solid rgba(144, 238, 144, 0.3);
            color: rgb(144, 238, 144);
            padding: 15px 20px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            border-radius: 8px;
            width: 100%;
            margin-bottom: 15px;
        }

        .event-option:hover {
            background: rgba(144, 238, 144, 0.1);
            transform: translateX(10px);
        }

        .result-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .result-screen.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .result-box {
            width: 80%;
            max-width: 600px;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            padding: 30px;
            color: white;
            text-align: center;
        }

        .result-text {
            font-size: 20px;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .game-over-screen.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .game-over-text {
            font-size: 120px;
            font-family: 'Orbitron', sans-serif;
            color: #FF0000;
            text-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
            animation: pulse 2s infinite ease-in-out;
            z-index: 10000;
            position: relative;
            margin-bottom: 50px;
            display: block;
        }

        .game-over-message {
            position: relative;
            font-size: 24px;
            color: #FFFFFF;
            text-align: center;
            max-width: 80%;
            line-height: 1.5;
            z-index: 10000;
            margin-bottom: 50px;
            display: block;
            padding: 0 20px;
        }

        .play-again-button {
            position: relative;
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 24px;
            border-radius: 5px;
            cursor: pointer;
            z-index: 10000;
            transition: background-color 0.3s ease;
            display: block;
        }

        .play-again-button:hover {
            background-color: #45a049;
        }

        @keyframes blink {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.2; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        .wealth-display.zero,
        #ph-value.zero,
        #mh-value.zero {
            color: #FF0000 !important;
            font-weight: bold;
            animation: blink 0.8s infinite;
        }

        /* 租房选择界面样式 */
        .housing-screen {
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            color: #E8DFD0;
            position: relative;  /* 添加相对定位 */
            height: 100vh;      /* 设置高度以便内部元素可以相对定位 */
        }

        .housing-title {
            font-size: 36px;
            position: absolute;
            top: 125px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            width: 100%;  /* 增加宽度 */
            white-space: nowrap;  /* 防止文字换行 */
        }

        .housing-slider-container {
            position: absolute;
            top: 250px;  /* 向下移动滑块区域 */
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
        }

        .housing-icons {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .housing-icon {
            width: 80px;  /* 增加图标容器大小 */
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;  /* 增加emoji大小 */
        }

        .housing-icon svg {
            width: 100%;
            height: 100%;
            fill: #E8DFD0;
        }

        .housing-icon-label {
            position: absolute;
            top: -30px;
            font-size: 14px;
            color: #E8DFD0;
        }

        .housing-slider {
            width: 100%;
            height: 4px;
            background: #444;
            position: relative;
            border-radius: 2px;
        }

        .housing-slider-thumb {
            width: 60px;  /* 增加背景大小 */
            height: 60px;  /* 增加背景大小 */
            background: #E8DFD0;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 48px;
            box-shadow: 0 0 10px rgba(232, 223, 208, 0.3);
        }

        .housing-slider-thumb:hover {
            background: #FFF;
        }

        .housing-distance {
            position: relative;
            width: 100%;
            text-align: center;
            font-size: 24px;
            color: #E8DFD0;
            margin: 60px 0 0 0;
        }

        .housing-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 30px 0;
            font-size: 24px;
            color: #E8DFD0;
            gap: 15px;
        }

        .housing-info .rent {
            color: #90EE90;  /* 租金显示为绿色 */
            margin: 20px 0;  /* 增加上下间距 */
        }

        .housing-pay {
            position: absolute;
            bottom: 150px;
            left: 50%;
            transform: translateX(-50%);
            background: #E8DFD0;
            color: #000;
            border: none;
            padding: 15px 60px;
            font-size: 24px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;  /* 只过渡背景色 */
        }

        .housing-pay:hover {
            background: #FFF;  /* 只改变背景色 */
        }

        /* 购物界面样式 */
        .grocery-screen {
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            color: #E8DFD0;
        }

        .grocery-title {
            font-size: 32px;
            margin-bottom: 20px;
            color: #E8DFD0;
            text-align: center;
            line-height: 1.5;
        }

        .grocery-question {
            font-size: 36px;
            font-weight: bold;
            margin: 30px 0;
            color: #E8DFD0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .grocery-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            margin: 0 auto;
            max-width: 600px;
        }

        .grocery-item {
            width: 60px;
            height: 60px;
            background-color: #E8DFD0;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            font-size: 32px;
            margin: 0 auto;
        }

        .grocery-item .count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #90EE90;
            color: black;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .grocery-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 50px;
            padding: 0 20px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 30px;
        }

        .grocery-clear {
            background: transparent;
            border: 1px solid #E8DFD0;
            color: #E8DFD0;
            padding: 12px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            border-radius: 5px;
            width: 120px;
        }

        .grocery-pay {
            background: #90EE90;
            border: none;
            color: black;
            padding: 12px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
            border-radius: 5px;
            width: 120px;
        }

        .grocery-item:hover {
            background-color: #FFF;
            transform: scale(1.1);
        }

        .grocery-item .tooltip {
            position: absolute;
            top: -45px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(144, 238, 144, 0.9);
            color: black;
            padding: 6px 15px;  /* 减小上下内边距 */
            border-radius: 5px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(144, 238, 144, 1);
            width: max-content;
            min-width: 0;
            z-index: 1000;
            height: 28px;  /* 减小高度 */
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .grocery-item:hover .tooltip {
            opacity: 1;
        }

        .grocery-total {
            font-size: 36px;
            color: #E8DFD0;
            font-family: 'Orbitron', sans-serif;
        }

        .grocery-clear:hover {
            background: rgba(232, 223, 208, 0.1);
        }

        .grocery-pay:hover {
            background: #7CCD7C;
            transform: scale(1.05);
        }

        .equipment-list {
            list-style: none;
            padding: 0;
            margin: 30px 0;
        }

        .equipment-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .equipment-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #90EE90;
            border-radius: 5px;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #90EE90;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .equipment-checkbox span {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .equipment-item.checked .equipment-checkbox span {
            opacity: 1;
        }

        .equipment-item.checked {
            background-color: rgba(144, 238, 144, 0.1);
        }

        .equipment-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .equipment-name {
            color: #E8DFD0;
            font-size: 18px;
        }

        .equipment-comment {
            color: #90EE90;
            font-style: italic;
            font-size: 16px;
            margin-top: 20px;
            text-align: center;
        }

        .equipment-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
            padding: 0 20px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 30px;
            gap: 20px;
        }

        .payday-screen {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            background-color: #90EE90;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .payday-screen.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .payday-text {
            font-size: 24px;
            color: black;
            text-align: center;
            margin-bottom: 10px;
        }

        .payday-amount {
            font-size: 20px;
            color: black;
            text-align: center;
            margin-bottom: 20px;
        }

        .payday-yuan {
            font-size: 72px;
            color: black;
            font-weight: bold;
        }

        .stat-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 30px;
        }
        
        .stat-item {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            font-size: 24px;
        }
        
        .stat-item.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .stat-label {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .stat-value {
            color: #90EE90;
        }

        .ending-content {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s ease, transform 1s ease;
        }

        .ending-content.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .credits-container {
            position: relative;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
            height: auto;
        }

        .credits-row {
            display: flex;
            width: 100%;
            max-width: 800px;
            margin-bottom: 30px;
            padding: 0 20px;
            font-size: 28px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .credits-row.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .credits-row.spacer {
            height: 60px;
        }

        .credits-label {
            flex: 1;
            text-align: left;
            font-weight: bold;
        }

        .credits-value {
            flex: 2;
            text-align: left;
        }

        .play-again-button {
            opacity: 0;
            transition: opacity 0.5s ease;
            margin-top: 30px;
        }

        .play-again-button.visible {
            opacity: 1;
        }

        .wealth-number {
            color: #FFD700;
            font-size: 14px;
            height: 20px;
            line-height: 20px;
            text-align: right;
            padding-right: 10px;
        }

        .summary-title {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 40px;
            text-align: center;
        }
        
        .stat-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 30px;
        }
        
        .stat-item {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            font-size: 24px;
        }
        
        .stat-item.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .stat-label {
            font-weight: bold;
            margin-right: 10px;
        }
        
        .stat-value {
            color: #90EE90;
        }

        .ending-content {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s ease, transform 1s ease;
        }

        .ending-content.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .credits-container {
            position: relative;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
            height: auto;
        }

        .credits-row {
            display: flex;
            width: 100%;
            max-width: 800px;
            margin-bottom: 30px;
            padding: 0 20px;
            font-size: 28px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .credits-row.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .credits-row.spacer {
            height: 60px;
        }

        .credits-label {
            flex: 1;
            text-align: left;
            font-weight: bold;
        }

        .credits-value {
            flex: 2;
            text-align: left;
        }

        .play-again-button {
            opacity: 0;
            transition: opacity 0.5s ease;
            margin-top: 30px;
        }

        .play-again-button.visible {
            opacity: 1;
        }

        .music-control {
            position: fixed;
            bottom: 100px;  /* 调整到logo上方 */
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            cursor: pointer;
            font-size: 20px;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .music-control:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }

        .wealth-container {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .wealth-number {
            font-size: 24px;
            color: #FFD700;  /* 金色 */
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .wealth-yuan {
            font-size: 20px;
            color: #FFD700;
            font-weight: bold;
        }

        /* 移除旧的进度条样式 */
        .wealth-bar {
            display: none;
        }

        .wealth-value {
            display: none;
        }

        /* 修改为新的财富显示样式 */
        .wealth-display {
            color: #FFD700;
            font-size: 16px;
            font-weight: bold;
            text-align: right;
        }

        /* 修改财富值显示样式 */
        #wealth-value {
            color: #FFD700;
            font-size: 16px;  /* 调整为与其他状态值相同的大小 */
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
            margin-left: 4px;
        }

        #wealth-value::before {
            content: "¥";
            margin-right: 2px;
        }

        /* 隐藏财富进度条 */
        .wealth-bar, 
        .status-bar-container:first-child .status-bar {
            display: none !important;
        }

        .status-bar-container:first-child .status-bar-label {
            margin-bottom: 0;
        }

        .status-value.zero {
            color: #FF0000;
            animation: blink 0.8s infinite;
        }

        @keyframes blink {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.2; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        .wealth-display.zero,
        #ph-value.zero,
        #mh-value.zero {
            color: #FF0000;
            animation: blink 0.8s infinite;
        }

        @keyframes blink {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.2; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        @keyframes blink {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(1.2); }
            100% { opacity: 1; transform: scale(1); }
        }

        .blink-animation {
            animation: blink 0.8s infinite ease-in-out !important;
            -webkit-animation: blink 0.8s infinite ease-in-out !important;
            text-shadow: 0 0 8px currentColor, 0 0 15px currentColor;
            font-weight: bold !important;
            font-size: 1.1em !important;
            display: inline-block;
            border: 1px solid currentColor;
            padding: 2px 5px;
            border-radius: 4px;
            transform-origin: center;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <audio id="bgMusic" loop>
        <source src="LIFE/岩田恭明 - イチカラ村.mp3" type="audio/mpeg">
    </audio>
    <div id="game-container">
        <div id="start-screen">
            <h1 class="title">LIFE</h1>
            <button class="start-button" onclick="startGame()">START</button>
        </div>
        <div id="opening-sequence" class="hidden"></div>
        <div id="dice-screen" class="hidden">
            <div class="dice-container">
                <div class="dice" id="dice" onclick="rollDice()">
                    <div class="dice-face face-1">
                        <span class="dot"></span>
                    </div>
                    <div class="dice-face face-2">
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                    <div class="dice-face face-3">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                    <div class="dice-face face-4">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                    <div class="dice-face face-5">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                    <div class="dice-face face-6">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                </div>
                <div class="click-instruction">Click to roll the dice</div>
            </div>
        </div>
        <div id="character-screen" class="hidden">
            <div class="character-screen">
                <div id="character-description" class="character-description"></div>
                
                <div class="health-bar-container">
                    <div class="health-bar-label">
                        <span>Physical Health</span>
                        <span id="physical-health-value">0/100</span>
                    </div>
                    <div class="health-bar">
                        <div id="physical-health-bar" class="health-bar-fill physical-health" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="health-bar-container">
                    <div class="health-bar-label">
                        <span>Mental Health</span>
                        <span id="mental-health-value">0/100</span>
                    </div>
                    <div class="health-bar">
                        <div id="mental-health-bar" class="health-bar-fill mental-health" style="width: 0%"></div>
                    </div>
                </div>
                
                <button class="continue-button" onclick="continueGame()">CONTINUE</button>
            </div>
        </div>
        <div id="newspaper-screen" class="newspaper-screen">
            <div class="newspaper">
                <div class="newspaper-title">Looking For a Job?
Try Being a Food Delivery Courier!</div>
                <div class="newspaper-content">
                    <span class="blur-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum consequat hendrerit nisi, vitae efficitur nunc. </span>
                    <span class="highlight">Flexible Working Hours</span>
                    <span class="blur-text">Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco. Duis aute irure dolor in reprehenderit. </span>
                    <span class="highlight">Low Entry Barrier</span>
                    <span class="blur-text">Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </span>
                    <span class="highlight">High Bonuses</span>
                    <span class="blur-text">Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. </span>
                    <span class="highlight">Well-Paid</span>
                    <span class="blur-text">Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore. </span>
                    <span class="highlight">Transparent Wages</span>
                    <span class="blur-text">Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur. At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident. Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et voluptates repudiandae sint et molestiae non recusandae. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus id quod maxime placeat facere possimus, omnis voluptas assumenda est, omnis dolor repellendus. Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</span>
                </div>
            </div>
        </div>
        <div id="transition-sequence" class="transition-sequence hidden"></div>
        <div id="info-screen" class="info-screen hidden">
            <div class="info-box">
                In China, full-time food delivery couriers are official employees who follow fixed shifts, work within a set area, and receive team support and equipment. Part-time couriers, on the other hand, work flexibly via an app without a contract, choose their own hours and locations, but must handle issues and gear on their own.
                <button class="info-continue-button" onclick="continueToMainGame()">CONTINUE</button>
            </div>
        </div>
        <div id="game-main-screen" class="game-main-screen">
            <div class="status-bars">
                <div class="status-bar-container">
                    <div class="status-bar-label">
                        <span>Wealth</span>
                        <span id="wealth-value" class="wealth-display">1000</span>
                    </div>
                </div>
                <div class="status-bar-container">
                    <div class="status-bar-label">
                        <span>Physical Health</span>
                        <span id="ph-value">0/100</span>
                    </div>
                    <div class="status-bar">
                        <div id="ph-bar" class="status-bar-fill physical-health" style="width: 0%"></div>
                    </div>
                </div>
                <div class="status-bar-container">
                    <div class="status-bar-label">
                        <span>Mental Health</span>
                        <span id="mh-value">0/100</span>
                    </div>
                    <div class="status-bar">
                        <div id="mh-bar" class="status-bar-fill mental-health" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <div class="calendar">
                <div class="calendar-header">April 2025</div>
                <div class="calendar-grid">
                    <div class="weekday">Su</div>
                    <div class="weekday">Mo</div>
                    <div class="weekday">Tu</div>
                    <div class="weekday">We</div>
                    <div class="weekday">Th</div>
                    <div class="weekday">Fr</div>
                    <div class="weekday">Sa</div>
                </div>
            </div>

            <div class="cash-options">
                <div class="cash-title">
                    <span>NEED</span>
                    <span>CASH?</span>
                </div>
                <div class="cash-buttons">
                    <button class="cash-button" onclick="smashPiggyBank(this)">
                        🐽
                        <span class="tooltip">Smash your piggy bank (W+500)</span>
                    </button>
                    <button class="cash-button" onclick="reqParentsLoan(this)">
                        🧑‍🧑‍🧒
                        <span class="tooltip">Ask your parents (W+2000, MH-20)</span>
                    </button>
                    <button class="cash-button" onclick="getLoan(this)">
                        💰
                        <span class="tooltip">Sell old items (W+200)</span>
                    </button>
                </div>
            </div>
            <div class="life-logo">LIFE</div>
        </div>
        <div id="company-selection-screen" class="company-selection-screen hidden">
            <div class="company-prompt">Choose the company that you want to work for</div>
            <div class="company-buttons">
                <button class="company-button meituan-button" onclick="selectCompany('meituan')">Meituan</button>
                <button class="company-button elema-button" onclick="selectCompany('elema')">Elema</button>
            </div>
            <div id="salary-info" class="salary-info"></div>
            <button id="company-continue" class="company-continue-button" onclick="continueToGame()">CONTINUE</button>
        </div>
        <div id="day-screen" class="day-screen">
            <div class="day-number">DAY 1</div>
        </div>

        <div id="event-screen" class="event-screen">
            <div class="event-container">
                <div class="housing-screen">
                    <div class="housing-title">FIND A PLACE TO LIVE</div>
                    <div class="housing-slider-container">
                        <div class="housing-icons">
                            <div class="housing-icon">
                                <span class="housing-icon-label">DELIVERY AREA</span>
                                <span>🛵</span>
                            </div>
                            <div class="housing-icon">
                                <span>🏙️</span>
                            </div>
                        </div>
                        <div class="housing-slider">
                            <div class="housing-slider-thumb" id="housing-thumb" style="left: 50%;">🏠</div>
                        </div>
                        <div class="housing-distance">DISTANCE: <span id="distance-value">10</span> KM</div>
                        <div class="housing-info">
                            <div>COMMUTING TIME: <span id="time-value">35</span> minutes</div>
                            <div class="rent">RENT: ¥<span id="rent-value">1025</span>/month</div>
                        </div>
                    </div>
                    <button class="housing-pay" onclick="selectHousing()">PAY</button>
                </div>
            </div>
        </div>

        <div id="result-screen" class="result-screen">
            <div class="result-box">
                <div id="result-text" class="result-text"></div>
                <button class="continue-button" onclick="nextDay()">CONTINUE</button>
            </div>
        </div>

        <div class="game-over-screen">
            <div class="game-over-text">GAME OVER</div>
            <div class="game-over-message"></div>
            <button class="play-again-button" onclick="location.reload()">再玩一次</button>
        </div>
    </div>

    <script>
        // 在文件开头添加全局变量
        let currentWealth = 1000;
        let currentPH = 100; // 临时初始值，将在选择角色后更新
        let currentMH = 100; // 临时初始值，将在选择角色后更新

        // 添加一个辅助函数用于修复wealth-bar的问题
        function updateWealthDisplay() {
            // 获取wealth-value元素并更新
            const wealthValue = document.getElementById('wealth-value');
            if (wealthValue) {
                wealthValue.textContent = currentWealth;
            }
            
            // 显式忽略wealth-bar的更新，因为该元素已经被移除
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
        }

        // 添加一个辅助函数用于限制health值在0-100之间
        function limitHealthValue(value) {
            if (value < 0) return 0;
            if (value > 100) return 100;
            return value;
        }

        // 注释掉旧的初始化日志，因为它显示的是临时值
        // console.log('Game initialized with values:', { currentWealth, currentPH, currentMH });

        // 添加安全更新财富显示的辅助函数
        // 角色数据
        const characters = [
            {
                description: "You (35 years old) dedicated years of your life to a company, working hard and never complaining. But as fresh college graduates flooded in, management started seeing you as outdated and less productive. Bills pile up, and your savings won't last long. Bearing the stress of supporting a large family of your parents, your spouse, and your children, you are so lost and have no idea what to do with your life.",
                physicalHealth: 80,
                mentalHealth: 75
            },
            {
                description: "You (24 years old) grew up in a small village, where opportunities were scarce. With nothing but hope, you arrive in a metropolis, dreaming of a better life. But reality hits hard—no work experience, no degree, and nowhere to stay. Feeling insecured, you have no idea what to do with your life.",
                physicalHealth: 90,
                mentalHealth: 85
            },
            {
                description: "You (28 years old) have made a mistake in the past—one that costs you years in prison. Now that you're finally free, you want to start fresh, but society isn't so forgiving. No one wants to hire someone with a criminal record. Job applications are rejected before you even get an interview. With no options left, you have no idea what to do with your life.",
                physicalHealth: 75,
                mentalHealth: 70
            },
            {
                description: "You (21 years old) went to university with big ambitions, but reality caught up—tuition fees, living costs, and pressure from family drained you. Eventually, you dropped out, unable to afford school any longer. Now, with no degree and no stable job, you have no idea what to do with your life.",
                physicalHealth: 85,
                mentalHealth: 80
            },
            {
                description: "You (30 years old) went through an unhealthy marriage that ended with divorce. Now, you're left raising a child alone, juggling responsibilities with no support. Your previous job didn't pay enough, and strict work hours made it impossible to be there for your kid. Every day feels like a struggle to stay afloat, and you have no idea what to do with your life.",
                physicalHealth: 85,
                mentalHealth: 75
            },
            {
                description: "You (32 years old) were once the CEO of a promising startup, leading a team, making deals, and living the high life. But a bad investment and an economic downturn wiped everything out. Bankrupt and drowning in debt, you have no choice but to start over. With no capital, no connections, and no time to waste, you have no idea what to do with your life.",
                physicalHealth: 90,
                mentalHealth: 70
            }
        ];

        const openingTexts = [
            "Welcome to LIFE",
            "Here, your choices shape the journey",
            "To receive a script of the first half of your life,",
            "roll a dice"
        ];

        let selectedCharacter = null;

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            const openingSequence = document.getElementById('opening-sequence');
            openingSequence.classList.remove('hidden');
            openingSequence.style.display = 'flex';
            openingSequence.style.justifyContent = 'center';
            openingSequence.style.alignItems = 'center';
            openingSequence.style.position = 'fixed';
            openingSequence.style.top = '0';
            openingSequence.style.left = '0';
            openingSequence.style.width = '100vw';
            openingSequence.style.height = '100vh';
            openingSequence.style.backgroundColor = 'black';
            
            // 添加游戏初始化代码，确保全局变量设置正确
            console.log("游戏启动 - 初始状态: ", {currentWealth, currentPH, currentMH});
            
            // 添加全局事件处理，确保能够捕获所有错误
            window.onerror = function(message, source, lineno, colno, error) {
                console.error("游戏错误: ", message, "行号:", lineno);
                return false;
            };
            
            // 添加全局游戏结束函数
            window.forceGameOver = function(reason) {
                console.log("强制结束游戏，原因:", reason);
                
                // 先调用强制闪烁函数
                window.forceValueBlink(reason);
                
                // 然后调用游戏结束函数
                if (reason === 'wealth') {
                    testGameOver('wealth');
                } else if (reason === 'ph') {
                    testGameOver('ph');
                } else if (reason === 'mh') {
                    testGameOver('mh');
                } else {
                    testGameOver();
                }
            };
            
            let currentText = null;
            
            openingTexts.forEach((text, index) => {
                setTimeout(() => {
                    if (currentText) {
                        currentText.style.animation = 'none';
                        currentText.remove();
                    }
                    
                    const textElement = document.createElement('div');
                    textElement.className = 'opening-text';
                    textElement.textContent = text;
                    textElement.style.animation = 'slideIn 2s ease-in-out forwards';
                    openingSequence.appendChild(textElement);
                    currentText = textElement;

                    if (index === openingTexts.length - 1) {
                        setTimeout(() => {
                            openingSequence.classList.add('hidden');
                            document.getElementById('dice-screen').classList.remove('hidden');
                        }, 1500);
                    }
                }, index * 2000);
            });
            playBackgroundMusic();
        }

        function rollDice() {
            const dice = document.getElementById('dice');
            
            // 禁用点击
            dice.style.pointerEvents = 'none';
            
            // 根据骰子面确定最终旋转角度
            const rotations = [
                'rotateX(0deg) rotateY(0deg) rotateZ(0deg)',        // 1
                'rotateX(0deg) rotateY(180deg) rotateZ(0deg)',      // 2
                'rotateX(0deg) rotateY(-90deg) rotateZ(0deg)',      // 3
                'rotateX(0deg) rotateY(90deg) rotateZ(0deg)',       // 4
                'rotateX(90deg) rotateY(0deg) rotateZ(0deg)',       // 5
                'rotateX(-90deg) rotateY(0deg) rotateZ(0deg)'       // 6
            ];
            
            // 随机生成1-6的数字
            const randomNum = Math.floor(Math.random() * 6) + 1;
            
            // 设置最终旋转角度
            dice.style.setProperty('--final-rotation', rotations[randomNum - 1]);
            
            // 添加骰子滚动动画
            dice.classList.add('dice-rolling');
            
            // 获取对应的角色
            selectedCharacter = characters[randomNum - 1];
            
            // 立即更新全局变量，使其与角色属性一致
            currentPH = selectedCharacter.physicalHealth;
            currentMH = selectedCharacter.mentalHealth;
            
            // 等待动画结束后显示角色信息
            setTimeout(() => {
                // 移除动画类，保持最终位置
                dice.classList.remove('dice-rolling');
                dice.style.transform = rotations[randomNum - 1];
                
                // 等待一小段时间后显示角色信息
                setTimeout(() => {
                    showCharacterInfo(randomNum);
                }, 1000);
            }, 1500); // 动画持续时间
        }

        function showCharacterInfo(characterNumber) {
            // 隐藏骰子界面
            document.getElementById('dice-screen').classList.add('hidden');
            
            // 显示角色信息
            const characterScreen = document.getElementById('character-screen');
            characterScreen.classList.remove('hidden');
            
            // 更新角色描述
            document.getElementById('character-description').textContent = selectedCharacter.description;
            
            // 更新健康值
            const physicalHealthBar = document.getElementById('physical-health-bar');
            const mentalHealthBar = document.getElementById('mental-health-bar');
            const physicalHealthValue = document.getElementById('physical-health-value');
            const mentalHealthValue = document.getElementById('mental-health-value');
            
            // 设置初始宽度为0，然后通过动画过渡到实际值
            setTimeout(() => {
                physicalHealthBar.style.width = currentPH + '%';
                mentalHealthBar.style.width = currentMH + '%';
                physicalHealthValue.textContent = currentPH + '/100';
                mentalHealthValue.textContent = currentMH + '/100';
                
                // 在此处记录真正的初始状态
                console.log('游戏初始化完成:', { 
                    角色: characterNumber, 
                    财富: currentWealth, 
                    身体健康: currentPH, 
                    精神健康: currentMH 
                });
            }, 100);
        }

        function updateGameStatus() {
            // 更新状态栏
            document.getElementById('wealth-value').textContent = currentWealth;
            
            // 现在只需更新UI显示，不需要再修改currentPH和currentMH的值
            // 因为这些值已经在角色选择时设置好了
            document.getElementById('ph-value').textContent = currentPH + '/100';
            document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
            
            document.getElementById('mh-value').textContent = currentMH + '/100';
            document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';

            // 更新日历
            updateCalendar();
            
            console.log('游戏状态已更新: Wealth =', currentWealth, 'PH =', currentPH, 'MH =', currentMH);
        }

        function updateCalendar() {
            const calendarGrid = document.querySelector('.calendar-grid');
            const days = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];
            
            // 清除现有的日期
            const weekdayElements = document.querySelectorAll('.weekday');
            weekdayElements.forEach(el => {
                if (!days.includes(el.textContent)) {
                    el.remove();
                }
            });

            // 添加4月的日期（2025年4月1日是周二）
            const totalDays = 30;
            const firstDay = 2; // 4月1日是周二
            
            // 添加空白天数
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                calendarGrid.appendChild(emptyDay);
            }
            
            // 添加日期
            for (let i = 1; i <= totalDays; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                if (i === 1) dayElement.classList.add('current');
                dayElement.textContent = i;
                calendarGrid.appendChild(dayElement);
            }
        }

        function smashPiggyBank(button) {
            if (button.classList.contains('used')) return;
            
            currentWealth += 500;
            updateWealthDisplay();
            
            button.classList.add('used');
        }

        function reqParentsLoan(button) {
            try {
                // 确保捕获所有可能的错误
                console.log('------ reqParentsLoan 开始执行 ------');
                console.log('初始状态: MH =', currentMH, 'Wealth =', currentWealth);
                
                // 如果按钮已被使用，直接返回
                if (button.classList.contains('used')) {
                    console.log('按钮已被使用，跳过处理');
                    return;
                }
                
                // 立即添加'used'类并禁用按钮，防止重复点击
                button.classList.add('used');
                button.disabled = true;
                button.style.pointerEvents = 'none';
                console.log('按钮已禁用');
                
                // 增加财富值
                currentWealth += 2000;
                console.log('财富更新: +2000，现在是', currentWealth);
                
                // 关键修改：记录原始MH值并强制减少20点
                const originalMH = currentMH;
                console.log('原始MH值:', originalMH);
                
                // 强制减少MH值20点
                currentMH = Math.max(0, currentMH - 20);
                console.log('已将MH值减少20点: 从', originalMH, '变为', currentMH);
                
                // 立即更新UI显示
                document.getElementById('wealth-value').textContent = currentWealth;
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                console.log('已更新UI显示');
                
                // 定义一个函数，在短暂延迟后验证MH值确实减少了20点
                const verifyMHValue = function() {
                    const expectedMH = Math.max(0, originalMH - 20);
                    console.log('验证MH值: 当前=', currentMH, '期望=', expectedMH);
                    
                    if (currentMH !== expectedMH) {
                        console.error('警告！MH值被意外修改！', '当前:', currentMH, '应该是:', expectedMH);
                        
                        // 强制纠正MH值为正确的减少20后的值
                        currentMH = expectedMH;
                        document.getElementById('mh-value').textContent = currentMH + '/100';
                        document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                        console.log('已纠正MH值为', currentMH);
                    } else {
                        console.log('MH值验证正确: 已减少20点');
                    }
                    
                    // 检查是否需要结束游戏
                    if (checkGameOver(currentWealth, currentPH, currentMH)) {
                        console.log('游戏结束检查触发');
                        return;
                    }
                };
                
                // 使用多个计时器在不同时间点验证MH值
                setTimeout(verifyMHValue, 50);
                setTimeout(verifyMHValue, 100);
                setTimeout(verifyMHValue, 200);
                setTimeout(function() {
                    verifyMHValue();
                    console.log('------ reqParentsLoan 执行完成 ------');
                }, 300);
                
            } catch (error) {
                console.error('reqParentsLoan函数发生错误:', error);
            }
        }

        function getLoan(button) {
            if (button.classList.contains('used')) return;
            
            currentWealth += 200;
            // 使用新的函数更新wealth显示
            updateWealthDisplay();
            
            button.classList.add('used');
        }

        const transitionTexts = [
            "With only ¥1000 left on hand,",
            "you've decided to start your life fresh",
            "as a full-time food delivery courier"
        ];

        function continueGame() {
            // 修改继续游戏的逻辑
            document.getElementById('character-screen').classList.add('hidden');
            document.getElementById('newspaper-screen').classList.add('visible');
            
            // 5秒后显示过渡文字
            setTimeout(() => {
                document.getElementById('newspaper-screen').classList.remove('visible');
                showTransitionSequence();
            }, 5000);
        }

        function showTransitionSequence() {
            const transitionSequence = document.getElementById('transition-sequence');
            transitionSequence.classList.remove('hidden');
            transitionSequence.style.display = 'flex';
            
            let currentText = null;
            
            transitionTexts.forEach((text, index) => {
                setTimeout(() => {
                    if (currentText) {
                        currentText.style.animation = 'none';
                        currentText.remove();
                    }
                    
                    const textElement = document.createElement('div');
                    textElement.className = 'opening-text';
                    textElement.textContent = text;
                    textElement.style.animation = 'slideIn 2s ease-in-out forwards';
                    transitionSequence.appendChild(textElement);
                    currentText = textElement;

                    if (index === transitionTexts.length - 1) {
                        setTimeout(() => {
                            transitionSequence.classList.add('hidden');
                            showInfoScreen();
                        }, 1500);
                    }
                }, index * 2000);
            });
        }

        function showInfoScreen() {
            const infoScreen = document.getElementById('info-screen');
            infoScreen.classList.remove('hidden');
        }

        function continueToMainGame() {
            document.getElementById('info-screen').classList.add('hidden');
            document.getElementById('company-selection-screen').classList.remove('hidden');
        }

        function selectCompany(company) {
            const salaryInfo = document.getElementById('salary-info');
            const continueButton = document.getElementById('company-continue');
            const buttons = document.querySelectorAll('.company-button');
            const companyPrompt = document.querySelector('.company-prompt');
            
            // 存储玩家的选择
            localStorage.setItem('company', company);
            
            // 隐藏公司选择按钮和提示文字
            buttons.forEach(button => button.style.display = 'none');
            companyPrompt.style.display = 'none';
            
            let content = '';
            
            if (company === 'meituan') {
                content = `
                    <div style="text-align: center;">
                        ¥8800 monthly pay before tax<br>
                        -¥240 tax<br>
                        ¥8560 monthly pay after tax
                    </div>
                    <div class="weekly-pay meituan-color">WEEKLY PAY</div>
                    <div class="pay-line" style="background-color: #FFC300"></div>
                    <div class="final-pay meituan-color">¥2140</div>
                `;
            } else {
                content = `
                    <div style="text-align: center;">
                        ¥9200 monthly pay before tax<br>
                        -¥280 tax<br>
                        ¥8920 monthly pay after tax
                    </div>
                    <div class="weekly-pay elema-color">WEEKLY PAY</div>
                    <div class="pay-line" style="background-color: #1E90FF"></div>
                    <div class="final-pay elema-color">¥2230</div>
                `;
            }
            
            salaryInfo.innerHTML = content;
            salaryInfo.classList.add('visible');
            continueButton.classList.add('visible');
        }

        function continueToGame() {
            document.getElementById('company-selection-screen').classList.add('hidden');
            document.getElementById('game-main-screen').classList.add('visible');
            updateGameStatus();
            startDay1();
        }

        let currentDay = 1;

        function startDay1() {
            const dayScreen = document.getElementById('day-screen');
            const dayNumber = dayScreen.querySelector('.day-number');
            
            dayScreen.classList.add('visible');
            setTimeout(() => {
                dayNumber.classList.add('visible');
                
                setTimeout(() => {
                    dayNumber.classList.remove('visible');
                    setTimeout(() => {
                        dayScreen.classList.remove('visible');
                        showDay1Content();
                    }, 500);
                }, 1500);
            }, 100);
        }

        function showDay1Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            // 清除原有的选项
            eventContainer.innerHTML = `
                <div class="event-text">
                    You checked in at the designated station, met the station manager and your future coworkers, completed onboarding training, and learned about your delivery area.
                </div>
                <button class="continue-button" onclick="nextDay()">CONTINUE</button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function nextDay() {
            document.getElementById('event-screen').classList.remove('visible');
            currentDay++;
            
            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
            
            // 显示第二天内容
            startDay2();
        }

        function startDay2() {
            const dayScreen = document.getElementById('day-screen');
            const dayNumber = dayScreen.querySelector('.day-number');
            dayNumber.textContent = 'DAY 2';
            
            dayScreen.classList.add('visible');
            setTimeout(() => {
                dayNumber.classList.add('visible');
                
                setTimeout(() => {
                    dayNumber.classList.remove('visible');
                    setTimeout(() => {
                        dayScreen.classList.remove('visible');
                        showDay2Content();
                    }, 500);
                }, 1500);
            }, 100);
        }

        function showDay2Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    What is the most essential piece of equipment for delivery? A vehicle.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="selectVehicle('electro')">
                    Get an electromobile (¥2000).
                </button>
                <button class="event-option" onclick="selectVehicle('motorcycle')">
                    Get a motorcycle (¥2500).
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function checkGameOver(wealth, ph, mh) {
            if (wealth < 0 || ph <= 0 || mh <= 0) {
                console.log("游戏结束条件触发: ", {wealth, ph, mh});
                
                let condition = '';
                
                // 确定游戏结束原因并立即应用闪烁效果
                if (wealth < 0) {
                    condition = 'wealth';
                    try {
                        const wealthValue = document.getElementById('wealth-value');
                        if (wealthValue) {
                            wealthValue.textContent = '0';
                            wealthValue.style.color = "#FFD700"; // 财富为金黄色
                            window.forceValueBlink('wealth');
                            console.log('checkGameOver: 财富值应用闪烁效果');
                        }
                    } catch (err) {
                        console.error('设置财富闪烁效果时出错:', err);
                    }
                } else if (ph <= 0) {
                    condition = 'ph';
                    try {
                        const phValue = document.getElementById('ph-value');
                        if (phValue) {
                            phValue.textContent = '0/100';
                            phValue.style.color = "#9C27B0"; // 体力为紫色
                            window.forceValueBlink('ph');
                            console.log('checkGameOver: 体力值应用闪烁效果');
                        }
                    } catch (err) {
                        console.error('设置体力闪烁效果时出错:', err);
                    }
                } else if (mh <= 0) {
                    condition = 'mh';
                    try {
                        const mhValue = document.getElementById('mh-value');
                        if (mhValue) {
                            mhValue.textContent = '0/100';
                            mhValue.style.color = "#F44336"; // 精神为红色
                            window.forceValueBlink('mh');
                            console.log('checkGameOver: 精神值应用闪烁效果');
                        }
                    } catch (err) {
                        console.error('设置精神闪烁效果时出错:', err);
                    }
                }
                
                // 延迟调用游戏结束函数，让闪烁效果先展示
                console.log("延迟1.5秒后显示游戏结束界面");
                showGameOverCountdown(1.5, condition);
                
                setTimeout(function() {
                    // 使用简化版的游戏结束函数
                    window.testGameOver(condition);
                }, 1500);
                
                return true;
            }
            return false;
        }

        // 创建一个完全独立的游戏结束界面
        function createFullGameOverScreen(message) {
            console.log("创建独立的游戏结束界面，消息:", message);
            
            // 确定游戏结束的原因和对应的颜色
            let zeroValueColor = "#FF0000"; // 默认红色
            let condition = '';
            
            if (currentWealth < 0) {
                condition = 'wealth';
                zeroValueColor = "#FFD700"; // 财富为金黄色
            } else if (currentPH <= 0) {
                condition = 'ph';
                zeroValueColor = "#9C27B0"; // 体力为紫色
            } else if (currentMH <= 0) {
                condition = 'mh';
                zeroValueColor = "#F44336"; // 精神为红色
            }
            
            // 创建一个新的DIV作为游戏结束屏幕
            const gameOverScreen = document.createElement('div');
            gameOverScreen.style.position = 'fixed';
            gameOverScreen.style.top = '0';
            gameOverScreen.style.left = '0';
            gameOverScreen.style.width = '100%';
            gameOverScreen.style.height = '100%';
            gameOverScreen.style.backgroundColor = 'rgba(0, 0, 0, 0.95)'; // 更暗的背景
            gameOverScreen.style.zIndex = '99999'; // 极高的z-index
            gameOverScreen.style.display = 'flex';
            gameOverScreen.style.flexDirection = 'column';
            gameOverScreen.style.justifyContent = 'center';
            gameOverScreen.style.alignItems = 'center';
            
            // 创建游戏结束文本
            const gameOverText = document.createElement('div');
            gameOverText.textContent = 'GAME OVER';
            gameOverText.style.fontSize = '120px';
            gameOverText.style.fontFamily = "'Orbitron', sans-serif";
            gameOverText.style.color = '#FF0000';
            gameOverText.style.textShadow = '0 0 20px rgba(255, 0, 0, 0.7)';
            // 删除animation属性，移除跳动效果
            gameOverText.style.marginBottom = '50px';
            gameOverText.style.zIndex = '100000'; // 确保文本在最上层
            gameOverScreen.appendChild(gameOverText);
            
            // 创建游戏结束消息
            const gameOverMessage = document.createElement('div');
            gameOverMessage.textContent = message;
            gameOverMessage.style.fontSize = '24px';
            gameOverMessage.style.color = '#FFFFFF';
            gameOverMessage.style.textAlign = 'center';
            gameOverMessage.style.maxWidth = '80%';
            gameOverMessage.style.lineHeight = '1.5';
            gameOverMessage.style.marginBottom = '50px';
            gameOverMessage.style.padding = '0 20px';
            gameOverMessage.style.zIndex = '100000'; // 确保消息在最上层
            gameOverScreen.appendChild(gameOverMessage);
            
            // 创建再玩一次按钮
            const playAgainButton = document.createElement('button');
            playAgainButton.textContent = 'PLAY AGAIN';
            playAgainButton.style.backgroundColor = '#4CAF50';
            playAgainButton.style.color = 'white';
            playAgainButton.style.border = 'none';
            playAgainButton.style.padding = '15px 30px';
            playAgainButton.style.fontSize = '24px';
            playAgainButton.style.borderRadius = '5px';
            playAgainButton.style.cursor = 'pointer';
            playAgainButton.style.transition = 'all 0.3s ease'; // 修改为all以包含所有属性
            playAgainButton.style.zIndex = '100000'; // 确保按钮在最上层
            
            // 按钮悬停效果
            playAgainButton.onmouseover = function() {
                this.style.backgroundColor = '#45a049';
                this.style.transform = 'scale(1.05)';
                this.style.boxShadow = '0 0 10px rgba(255, 255, 255, 0.5)';
            };
            playAgainButton.onmouseout = function() {
                this.style.backgroundColor = '#4CAF50';
                this.style.transform = 'scale(1)';
                this.style.boxShadow = 'none';
            };
            
            // 点击重新开始游戏
            playAgainButton.onclick = function() {
                console.log("点击重新开始游戏按钮");
                location.reload();
            };
            
            gameOverScreen.appendChild(playAgainButton);
            
            // 将游戏结束屏幕添加到文档中
            document.body.appendChild(gameOverScreen);
            
            // 定义闪烁动画
            try {
                // 首先检查是否已经存在同名动画，避免重复定义
                const existingStyle = document.getElementById('blink-animation-style');
                if (!existingStyle) {
                    const style = document.createElement('style');
                    style.id = 'blink-animation-style';
                    style.textContent = `
                        @keyframes blink {
                            0% { opacity: 1; transform: scale(1); }
                            50% { opacity: 0.2; transform: scale(1.2); }
                            100% { opacity: 1; transform: scale(1); }
                        }
                    `;
                    document.head.appendChild(style);
                    console.log('成功添加闪烁动画样式');
                }
                
                // 更新状态显示，应用闪烁效果和对应颜色
                if (condition === 'wealth') {
                    const wealthValue = document.getElementById('wealth-value');
                    if (wealthValue) {
                        wealthValue.textContent = '0';
                        wealthValue.style.color = zeroValueColor;
                        // 使用更强的方式应用动画
                        wealthValue.style.cssText += `
                            animation: blink 0.8s infinite ease-in-out !important;
                            -webkit-animation: blink 0.8s infinite ease-in-out !important;
                        `;
                        console.log('财富值应用闪烁效果:', wealthValue.style.animation);
                    } else {
                        console.error('未找到财富值元素');
                    }
                } else if (condition === 'ph') {
                    const phValue = document.getElementById('ph-value');
                    if (phValue) {
                        phValue.textContent = '0/100';
                        phValue.style.color = zeroValueColor;
                        // 使用更强的方式应用动画
                        phValue.style.cssText += `
                            animation: blink 0.8s infinite ease-in-out !important;
                            -webkit-animation: blink 0.8s infinite ease-in-out !important;
                        `;
                        console.log('体力值应用闪烁效果:', phValue.style.animation);
                    } else {
                        console.error('未找到体力值元素');
                    }
                } else if (condition === 'mh') {
                    const mhValue = document.getElementById('mh-value');
                    if (mhValue) {
                        mhValue.textContent = '0/100';
                        mhValue.style.color = zeroValueColor;
                        // 使用更强的方式应用动画
                        mhValue.style.cssText += `
                            animation: blink 0.8s infinite ease-in-out !important;
                            -webkit-animation: blink 0.8s infinite ease-in-out !important;
                        `;
                        console.log('精神值应用闪烁效果:', mhValue.style.animation);
                    } else {
                        console.error('未找到精神值元素');
                    }
                }
                
                // 为确保动画生效，强制重绘
                if (condition) {
                    const targetElement = condition === 'wealth' ? 
                        document.getElementById('wealth-value') : 
                        (condition === 'ph' ? 
                            document.getElementById('ph-value') : 
                            document.getElementById('mh-value'));
                    
                    if (targetElement) {
                        // 触发重排以确保动画生效
                        targetElement.offsetHeight;
                        console.log('成功触发重排');
                    }
                }
            } catch (styleError) {
                console.error('添加动画样式或更新状态显示时出错:', styleError);
            }
            
            // 额外确保屏幕的可见性
            setTimeout(() => {
                gameOverScreen.style.opacity = '1';
                console.log("确保游戏结束屏幕完全可见");
            }, 100);
            
            console.log("游戏结束界面创建完成并添加到文档");
            
            // 移除可能干扰的其他界面
            const possibleInterferences = [
                '.event-screen', 
                '.day-screen', 
                '.result-screen',
                '.payday-screen'
            ];
            
            possibleInterferences.forEach(selector => {
                const element = document.querySelector(selector);
                if (element) {
                    element.style.display = 'none';
                    console.log(`隐藏可能干扰的元素: ${selector}`);
                }
            });
        }

        function selectVehicle(type) {
            const cost = type === 'electro' ? 2000 : 2500;
            
            // 先检查余额是否足够
            if (currentWealth - cost < 0) {
                // 直接调用forceGameOver函数处理游戏结束
                console.log("购买交通工具失败，触发游戏结束 - 当前财富:", currentWealth, "费用:", cost);
                currentWealth = -1; // 将财富设为负数
                window.forceGameOver('wealth');
                return;
            }
            
            // 扣除费用
            currentWealth = currentWealth - cost;
            
            // 更新状态显示
            updateWealthDisplay();
            
            // 显示选择结果并清除之前的内容
            const eventContainer = document.querySelector('.event-container');
            
            const resultText = type === 'electro' 
                ? "You've chosen the electromobile. It's cheaper but requires more maintenance."
                : "You've chosen the motorcycle. It's more expensive but requires less maintenance.";
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <button class="continue-button" onclick="startDay3()">CONTINUE</button>
            `;
        }

        function startDay3() {
            // 先清除Day 2的内容
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = '';  // 清除Day 2的内容
            eventScreen.classList.remove('visible');  // 隐藏事件屏幕

            const dayScreen = document.getElementById('day-screen');
            const dayNumber = dayScreen.querySelector('.day-number');
            dayNumber.textContent = 'DAY 3';
            
            dayScreen.classList.add('visible');
            setTimeout(() => {
                dayNumber.classList.add('visible');
                
                setTimeout(() => {
                    dayNumber.classList.remove('visible');
                    setTimeout(() => {
                        dayScreen.classList.remove('visible');
                        setTimeout(() => {
                            showDay3Content();
                        }, 100); // 减少延迟，确保快速显示Day 3内容
                    }, 500);
                }, 1500);
            }, 100);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay3Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            // 清除之前的内容，确保干净的开始
            eventContainer.innerHTML = '';
            
            // 设置新的内容
            eventContainer.innerHTML = `
                <div class="housing-screen">
                    <div class="housing-title">FIND A PLACE TO LIVE</div>
                    <div class="housing-slider-container">
                        <div class="housing-icons">
                            <div class="housing-icon">
                                <span class="housing-icon-label">DELIVERY AREA</span>
                                <span>🛵</span>
                            </div>
                            <div class="housing-icon">
                                <span>🏙️</span>
                            </div>
                        </div>
                        <div class="housing-slider">
                            <div class="housing-slider-thumb" id="housing-thumb" style="left: 50%;">🏠</div>
                        </div>
                        <div class="housing-distance">DISTANCE: <span id="distance-value">10</span> KM</div>
                        <div class="housing-info">
                            <div>COMMUTING TIME: <span id="time-value">35</span> minutes</div>
                            <div class="rent">RENT: ¥<span id="rent-value">1025</span>/month</div>
                        </div>
                    </div>
                    <button class="housing-pay" onclick="selectHousing()">PAY</button>
                </div>
            `;
            
            // 确保事件屏幕可见
            eventScreen.classList.add('visible');

            // 初始化滑块功能
            setTimeout(() => {
                const thumb = document.getElementById('housing-thumb');
                const slider = document.querySelector('.housing-slider');
                const rentValue = document.getElementById('rent-value');
                const timeValue = document.getElementById('time-value');
                const distanceValue = document.getElementById('distance-value');
                
                if (!thumb || !slider || !rentValue || !timeValue || !distanceValue) {
                    console.error('Housing UI elements not found');
                    return;
                }
                
                let isDragging = false;
                
                // 计算值的函数
                function calculateValues(position) {
                    const percent = position / slider.offsetWidth;
                    const rent = Math.round(1200 - (350 * percent));
                    const time = Math.round(10 + (50 * percent));
                    const distance = Math.round(1 + (19 * percent)); // 改为1-20km
                    
                    rentValue.textContent = rent;
                    timeValue.textContent = time;
                    distanceValue.textContent = distance;
                    
                    return { rent, time, distance };
                }
                
                // 更新滑块位置
                function updateThumbPosition(e) {
                    if (!isDragging) return;
                    
                    const rect = slider.getBoundingClientRect();
                    let position = Math.max(0, Math.min(e.clientX - rect.left, rect.width));
                    
                    thumb.style.left = `${position}px`;
                    calculateValues(position);
                }
                
                // 事件监听器
                thumb.addEventListener('mousedown', () => isDragging = true);
                document.addEventListener('mousemove', updateThumbPosition);
                document.addEventListener('mouseup', () => isDragging = false);
                
                // 点击滑块区域直接移动
                slider.addEventListener('click', (e) => {
                    const rect = slider.getBoundingClientRect();
                    const position = Math.max(0, Math.min(e.clientX - rect.left, rect.width));
                    thumb.style.left = `${position}px`;
                    calculateValues(position);
                });
                
                // 不再在这里设置滑块位置，而是使用HTML中已设置的位置
                // 只计算初始值
                const sliderWidth = slider.offsetWidth;
                const initialPosition = sliderWidth / 2;
                calculateValues(initialPosition);
            }, 100); // 添加短延迟确保DOM元素已加载
        }

        function selectHousing() {
    const rentValue = parseInt(document.getElementById('rent-value').textContent);

    // 检查是否有足够的钱支付房租
    if (currentWealth < rentValue) {
        // 设置财富为负数以触发游戏结束
        console.log("房租支付失败，触发游戏结束 - 当前财富:", currentWealth, "房租:", rentValue);
        currentWealth = -1;
        // 直接使用测试函数显示游戏结束
        window.forceGameOver('wealth');
        return;
    }

    // 扣除房租
    currentWealth -= rentValue;

    // 更新状态显示
    updateWealthDisplay();
    
    // 获取通勤时间、距离
    const commutingTime = document.getElementById('time-value').textContent;
    const distance = document.getElementById('distance-value').textContent;

    // 获取事件容器
    const eventScreen = document.getElementById('event-screen');
    const eventContainer = document.querySelector('.event-container');

    // 移除旧的 housing-screen（如果还在）
    const housingScreen = eventContainer.querySelector('.housing-screen');
    if (housingScreen) {
        eventContainer.removeChild(housingScreen);
    }

    // 设置新内容
    eventContainer.innerHTML = `
        <div class="event-text">
            You found a place to live ${distance} km from your delivery area.<br>
            Your daily commute will take ${commutingTime} minutes.<br>
            Monthly rent: ¥${rentValue}
        </div>
        <div class="event-text" style="color: #90EE90; margin-top: 20px;">Wealth - ${rentValue}</div>
        <button class="continue-button" onclick="startDay4()">CONTINUE</button>
    `;

    // 确保事件屏幕可见
    eventScreen.classList.add('visible');
}

        function startDay4() {
            console.log("Starting Day 4...");
            const eventScreen = document.getElementById('event-screen');
            
            // 确保正确隐藏事件屏幕
            if (eventScreen) {
                eventScreen.classList.remove('visible');
            } else {
                console.error("Event screen not found!");
            }
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                if (!dayScreen) {
                    console.error("Day screen not found!");
                    return;
                }
                
                const dayNumber = dayScreen.querySelector('.day-number');
                if (!dayNumber) {
                    console.error("Day number element not found!");
                    return;
                }
                
                dayNumber.textContent = 'DAY 4';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay4Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay4Content() {
            console.log('showDay4Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">The company asks if you want to pay for social security, which is ¥4200/year (¥350/month).</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleSocialSecurity('pay')">Pay</button>
                <button class="event-option" onclick="handleSocialSecurity('skip')">DUH, I ain't got money for that.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleSocialSecurity(choice) {
            console.log('handleSocialSecurity called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            // 存储玩家的选择
            localStorage.setItem('socialSecurityChoice', choice);
            
            if (choice === 'pay') {
                // 更新状态
                currentWealth -= 350;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                
                // 检查游戏是否结束
                if (currentWealth < 0) {
                    console.log("支付社保失败，触发游戏结束 - 当前财富:", currentWealth);
                    window.forceGameOver('wealth');
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Social security includes endowment insurance, unemployment insurance, medical insurance, maternity insurance, and most importantly work-related injury insurance. Work-related injury insurance provides compensation for wages and coverage of medical fees when couriers encounter any accidents.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 350</div>
                    <button class="continue-button" onclick="startDay5()">CONTINUE</button>
                `;
            } else if (choice === 'skip') {
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You decided not to pay for social security. This might affect your future benefits and protection.</div>
                    <button class="continue-button" onclick="startDay5()">CONTINUE</button>
                `;
            }
        }

        function startDay5() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 5';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay5Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay5Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    The order was delayed because the merchant was slow in preparing the food.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleMerchantDelay('argue')">
                    Argue with the merchant.
                </button>
                <button class="event-option" onclick="handleMerchantDelay('explain')">
                    Kindly explain to the customer.
                </button>
                <button class="event-option" onclick="handleMerchantDelay('ignore')">
                    I don't care, just give me a bad review and deduct my delivery fee.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleMerchantDelay(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let statusChangeText = '';
            
            if (choice === 'argue') {
                currentWealth -= 5;
                currentPH -= 5;
                currentMH -= 5;
                
                // 使用辅助函数更新财富显示
                updateWealthDisplay();
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏状态
                if (currentWealth < 0) {
                    console.log("财富归零，触发游戏结束");
                    window.forceGameOver('wealth');
                    return;
                }
                if (currentPH <= 0) {
                    console.log("体力归零，触发游戏结束");
                    window.forceGameOver('ph'); 
                    return;
                }
                if (currentMH <= 0) {
                    console.log("精神归零，触发游戏结束");
                    window.forceGameOver('mh');
                    return;
                }
                
                resultText = "You spent 10 minutes arguing and the order is even more delayed. The customer gave you a bad review and the system deducted ¥5 delivery fee as a fine.";
                statusChangeText = "Wealth - 5, Physical Health - 5, Mental Health - 5";
            } else if (choice === 'explain') {
                currentWealth -= 5;
                
                // 使用辅助函数更新财富显示
                updateWealthDisplay();
                
                // 检查游戏状态
                if (currentWealth < 0) {
                    console.log("财富归零，触发游戏结束");
                    window.forceGameOver('wealth');
                    return;
                }
                
                resultText = "In fact, most customers are understanding, so they did not make a fuss about it. But still, the system deducted ¥5 delivery fee as a fine.";
                statusChangeText = "Wealth - 5";
            } else if (choice === 'ignore') {
                currentWealth -= 5;
                currentMH -= 5;
                
                // 使用辅助函数更新财富显示
                updateWealthDisplay();
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏状态
                if (currentWealth < 0) {
                    console.log("财富归零，触发游戏结束");
                    window.forceGameOver('wealth');
                    return;
                }
                if (currentMH <= 0) {
                    console.log("精神归零，触发游戏结束");
                    window.forceGameOver('mh');
                    return;
                }
                
                resultText = "You got a bad review and the system deducted ¥5 delivery fee as a fine.";
                statusChangeText = "Wealth - 5, Mental Health - 5";
            }
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay6()">CONTINUE</button>
            `;
        }

        function startDay6() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 6';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay6Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay6Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    You reach a gated community, but security won't let you in without a resident code. The customer isn't answering texts or calls. And your other deliveries are piling up.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleGatedCommunity('wait')">
                    Wait outside the gate and keep trying to call.
                </button>
                <button class="event-option" onclick="handleGatedCommunity('leave')">
                    Leave the order at the gate and mark it as delivered.
                </button>
                <button class="event-option" onclick="handleGatedCommunity('convince')">
                    Repeatedly convince the guard to let you in.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleGatedCommunity(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let statusChangeText = '';
            
            if (choice === 'wait') {
                currentWealth -= 20;
                currentPH -= 5;
                currentMH -= 5;
                
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                resultText = "Costs your major time and ruins your schedule.";
                statusChangeText = "Wealth - 20, Physical Health - 5, Mental Health - 5";
            } else if (choice === 'leave') {
                resultText = "You risk a complaint if the customer says they never got it. But luckily, they are understanding and never asked for trouble.";
                statusChangeText = "";
            } else if (choice === 'convince') {
                currentPH -= 5;
                
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                resultText = "They agree reluctantly. Luckily, you stay mostly on time.";
                statusChangeText = "Physical Health - 5";
            }
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay7()">CONTINUE</button>
            `;
        }

        function startDay7() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 7';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showPayday();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showPayday() {
            const paydayScreen = document.createElement('div');
            paydayScreen.className = 'payday-screen';
            const company = localStorage.getItem('company');
            const salary = company === 'meituan' ? 2140 : 2230;
            
            paydayScreen.innerHTML = `
                <div class="payday-text">PAYDAY!</div>
                <div class="payday-amount">Wealth + ${salary}</div>
                <div class="payday-yuan">¥</div>
            `;
            document.body.appendChild(paydayScreen);
            
            // 更新财富值
            currentWealth += salary;
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            
            // 显示payday屏幕
            setTimeout(() => {
                paydayScreen.classList.add('visible');
                
                // 3秒后隐藏payday屏幕并显示day7内容
                setTimeout(() => {
                    paydayScreen.classList.remove('visible');
                    setTimeout(() => {
                        paydayScreen.remove();
                        showDay7Content();
                    }, 500);
                }, 3000);
            }, 100);
        }

        function showDay7Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            // 创建购物界面
            eventContainer.innerHTML = `
                <div class="grocery-screen">
                    <div class="grocery-title">Just got paid? First stop: groceries.<br>Plan wisely—this has to last a while.</div>
                    <div class="grocery-question">WHAT DO YOU WANT TO BUY?</div>
                    <div class="grocery-grid">
                        <div class="grocery-item" onclick="addItem(this, 10)" data-price="10">
                            🍎
                            <div class="count">0</div>
                            <div class="tooltip">3 apples (¥10)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 10)" data-price="10">
                            🍌
                            <div class="count">0</div>
                            <div class="tooltip">5 bananas (¥10)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 8)" data-price="8">
                            🍐
                            <div class="count">0</div>
                            <div class="tooltip">2 pears (¥8)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 10)" data-price="10">
                            🍊
                            <div class="count">0</div>
                            <div class="tooltip">4 oranges (¥10)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 8)" data-price="8">
                            🥬
                            <div class="count">0</div>
                            <div class="tooltip">250g vegetable (¥8)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 8)" data-price="8">
                            🌽
                            <div class="count">0</div>
                            <div class="tooltip">2 corns (¥8)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 8)" data-price="8">
                            🥕
                            <div class="count">0</div>
                            <div class="tooltip">400g carrot (¥8)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 8)" data-price="8">
                            🍞
                            <div class="count">0</div>
                            <div class="tooltip">1 bag of toast (¥8)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 20)" data-price="20">
                            🥚
                            <div class="count">0</div>
                            <div class="tooltip">12 eggs (¥20)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 18)" data-price="18">
                            🥩
                            <div class="count">0</div>
                            <div class="tooltip">200g beef (¥18)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 15)" data-price="15">
                            🥫
                            <div class="count">0</div>
                            <div class="tooltip">1 canned food (¥15)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 5)" data-price="5">
                            🍜
                            <div class="count">0</div>
                            <div class="tooltip">1 pack of instant noodles (¥5)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 12)" data-price="12">
                            🥟
                            <div class="count">0</div>
                            <div class="tooltip">500g dumpling (¥12)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 15)" data-price="15">
                            🍚
                            <div class="count">0</div>
                            <div class="tooltip">1kg rice (¥15)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 15)" data-price="15">
                            🥛
                            <div class="count">0</div>
                            <div class="tooltip">500mL milk (¥15)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 6)" data-price="6">
                            🧃
                            <div class="count">0</div>
                            <div class="tooltip">300mL juice (¥6)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 15)" data-price="15">
                            🍺
                            <div class="count">0</div>
                            <div class="tooltip">4 cans of beer (¥15)</div>
                        </div>
                        <div class="grocery-item" onclick="addItem(this, 16)" data-price="16">
                            🧻
                            <div class="count">0</div>
                            <div class="tooltip">5 roll paper (¥16)</div>
                        </div>
                    </div>
                    <div class="grocery-controls">
                        <button class="grocery-clear" onclick="clearItems()">CLEAR</button>
                        <div class="grocery-total">$0</div>
                        <button class="grocery-pay" onclick="payItems()">PAY</button>
                    </div>
                </div>
            `;
            
            eventScreen.classList.add('visible');
        }

        let totalAmount = 0;

        function addItem(element, price) {
            const countElement = element.querySelector('.count');
            let count = parseInt(countElement.textContent) || 0;
            count++;
            countElement.textContent = count;
            countElement.style.opacity = '1';
            
            totalAmount += price;
            document.querySelector('.grocery-total').textContent = '¥' + totalAmount;
        }

        function clearItems() {
            const countElements = document.querySelectorAll('.count');
            countElements.forEach(element => {
                element.textContent = '0';
                element.style.opacity = '0';
            });
            
            totalAmount = 0;
            document.querySelector('.grocery-total').textContent = '¥0';
        }

        function payItems() {
            if (totalAmount === 0) {
                const eventContainer = document.querySelector('.event-container');
                eventContainer.innerHTML = `
                    <div class="event-text">Did not buy anything? Be careful, you might have a hard time in the future.</div>
                    <button class="continue-button" onclick="startDay8()">CONTINUE</button>
                `;
                return;
            }

            if (currentWealth < totalAmount) {
                document.querySelector('.game-over-screen').classList.add('visible');
                return;
            }

            currentWealth -= totalAmount;
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';

            const eventContainer = document.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">You bought groceries for ¥${totalAmount}.</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">Wealth - ${totalAmount}</div>
                <button class="continue-button" onclick="startDay8()">CONTINUE</button>
            `;
        }

        function startDay8() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 8';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay8Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        let equipmentTotal = 0;
        let selectedEquipment = new Set();

        function showDay8Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    The platform sends you a message reminding you to upgrade your equipment. For full-time delivery couriers, a vest, a helmet, and an insulated delivery box with the company's logo are necessities.
                </div>
                <div class="equipment-list">
                    <div class="equipment-item" onclick="toggleEquipment(this, 'vest', 200)">
                        <div class="equipment-checkbox"><span>✓</span></div>
                        <div class="equipment-name">A vest (¥200)</div>
                    </div>
                    <div class="equipment-item" onclick="toggleEquipment(this, 'helmet', 100)">
                        <div class="equipment-checkbox"><span>✓</span></div>
                        <div class="equipment-name">A helmet (¥100)</div>
                    </div>
                    <div class="equipment-item" onclick="toggleEquipment(this, 'box', 50)">
                        <div class="equipment-checkbox"><span>✓</span></div>
                        <div class="equipment-name">An insulated delivery box (¥50)</div>
                    </div>
                </div>
                <div class="equipment-controls">
                    <div class="grocery-total">¥0</div>
                    <button class="grocery-pay" onclick="payEquipment()">PAY</button>
                </div>
            `;
            
            eventScreen.classList.add('visible');
            equipmentTotal = 0;
            selectedEquipment.clear();
        }

        function toggleEquipment(element, type, price) {
            if (element.classList.contains('disabled')) {
                return;
            }

            if (element.classList.contains('checked')) {
                element.classList.remove('checked');
                equipmentTotal -= price;
                selectedEquipment.delete(type);
            } else {
                element.classList.add('checked');
                equipmentTotal += price;
                selectedEquipment.add(type);
            }

            document.querySelector('.grocery-total').textContent = '¥' + equipmentTotal;
        }

        function clearEquipment() {
            const items = document.querySelectorAll('.equipment-item');
            items.forEach(item => {
                item.classList.remove('checked');
            });
            
            equipmentTotal = 0;
            selectedEquipment.clear();
            document.querySelector('.grocery-total').textContent = '¥0';
        }

        function payEquipment() {
            if (equipmentTotal === 0) {
                const eventContainer = document.querySelector('.event-container');
                eventContainer.innerHTML = `
                    <div class="event-text">Did not buy anything? Be careful, you might have a hard time in the future.</div>
                    <button class="continue-button" onclick="startDay9()">CONTINUE</button>
                `;
                return;
            }

            if (currentWealth < equipmentTotal) {
                document.querySelector('.game-over-screen').classList.add('visible');
                return;
            }

            currentWealth -= equipmentTotal;
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';

            const eventContainer = document.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">What a great way to advertise and to show corporate culture!</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">Wealth - ${equipmentTotal}</div>
                <button class="continue-button" onclick="startDay9()">CONTINUE</button>
            `;
        }

        function startDay9() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 9';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay9Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay9Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    A customer left you a note, telling you to ride slower, not to rush, and to be safe.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleCustomerNote('first')">
                    You are touched and decided to deliver their order first.
                </button>
                <button class="event-option" onclick="handleCustomerNote('last')">
                    You decided to deliver their order last because you're certain that you will not receive a bad review from them.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleCustomerNote(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let mhChange = 0;
            
            switch(choice) {
                case 'first':
                    mhChange = 10;
                    resultText = "The customer is surprised when they get their order within such a short time and hand you a bottle of water.";
                    break;
                case 'last':
                    mhChange = -5;
                    resultText = "You felt like a bad person.";
                    break;
            }
            
            // 更新状态显示
            currentMH += mhChange;
            
            // 确保更新值在合理范围内
            currentMH = Math.min(100, Math.max(0, currentMH));
            
            document.getElementById('mh-value').textContent = currentMH + '/100';
            document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
            
            // 构建状态变化文本
            let statusChangeText = '';
            if (mhChange !== 0) statusChangeText += `Mental Health ${mhChange > 0 ? '+ ' : '- '}${Math.abs(mhChange)}`;
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay10()">CONTINUE</button>
            `;
        }

        function startDay10() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 10';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay10Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay10Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    The system tracks your delivery speed and notices that your average delivery time is usually faster than estimated. So, it's now shortening your ETA (estimated time of arrival) gradually.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleETAChange('faster')">
                    Live with it and try to be even faster. 
                </button>
                <button class="event-option" onclick="handleETAChange('fight')">
                    Try to fight with the system.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleETAChange(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let mhChange = 0;
            let phChange = 0;
            
            switch(choice) {
                case 'faster':
                    phChange = -5;
                    resultText = "In fact, this is what most couriers do, because they don't have a choice. Living under the algorithms forces them to be more 'efficient', sometimes at the cost of their safety.";
                    break;
                case 'fight':
                    mhChange = -5;
                    resultText = "Sadly, it's a useless fight. The algorithms are preset to monitor couriers' acts. You can't do anything but live along with it.";
                    break;
            }
            
            // 更新状态显示
            currentMH += mhChange;
            currentPH = limitHealthValue(currentPH + phChange);
            document.getElementById('mh-value').textContent = currentMH + '/100';
            document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
            document.getElementById('ph-value').textContent = currentPH + '/100';
            document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
            // 检查游戏是否结束
            if (checkGameOver(currentWealth, currentPH, currentMH)) {
                return;
            }
            
            // 构建状态变化文本
            let statusChangeText = '';
            if (phChange !== 0) statusChangeText += `Physical Health ${phChange > 0 ? '+ ' : '- '}${Math.abs(phChange)} `;
            if (mhChange !== 0) statusChangeText += `Mental Health ${mhChange > 0 ? '+ ' : '- '}${Math.abs(mhChange)}`;
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay11()">CONTINUE</button>
            `;
        }

        // DAY 11 事件处理函数
        function startDay11() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 11';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay11Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay11Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    When picking up an order from the mall, your attention was caught by a sign that said, "Couriers please use the freight elevators, not escalators". Rushing in time, you ran onto an escalator. A security guard came and scolded you for not following the rules. You got mad and shouted back, running up the escalator and ignoring the security guard's disapproval. A crowd quickly formed around this drama. People started a discussion on who was right and who was wrong in this incident. Is it you? Who feels marginalized and just wants to deliver the order on time. Or is it the security guard? Who's just doing his job and following the instructions.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleSecurityGuard('submit')">
                    Submit to humiliation and run away.
                </button>
                <button class="event-option" onclick="handleSecurityGuard('speech')">
                    Make a speech in public about how your couriers often suffer from discrimination in public places.
                </button>
                <button class="event-option" onclick="handleSecurityGuard('fight')">
                    Go into a fight with the security guard.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleSecurityGuard(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let wealthChange = 0;
            let phChange = 0;
            let mhChange = 0;
            
            switch(choice) {
                case 'submit':
                    mhChange = -10;
                    resultText = "In between defending your dignity and making sure your order did not overrun; you chose the latter.";
                    break;
                case 'speech':
                    resultText = "It is true that society is treating food delivery couriers badly, putting restrictions on them, and looking down on them. I personally do think they, working for the convenience of others, deserve more attention, care, and understanding. However, altering the public perception of an occupation isn't something that an individual can do it alone, it requires help from the public, starting from being thankful for their work and treating them with respect and justice.";
                    break;
                case 'fight':
                    phChange = -10;
                    mhChange = -5;
                    wealthChange = -5;
                    resultText = "He's a blue-collar worker just like you, so try not to give each other a hard time. Yet, your order ran over time and ¥5 delivery fee was deducted as a fine.";
                    break;
            }
            
            // 更新状态显示
            currentWealth += wealthChange;
            currentPH = limitHealthValue(currentPH + phChange);
            currentMH = limitHealthValue(currentMH + mhChange);
            
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            document.getElementById('ph-value').textContent = currentPH + '/100';
            document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
            document.getElementById('mh-value').textContent = currentMH + '/100';
            document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
            
            // 检查游戏是否结束
            if (checkGameOver(currentWealth, currentPH, currentMH)) {
                return;
            }
            
            // 构建状态变化文本
            let statusChangeText = '';
            if (wealthChange !== 0) statusChangeText += `Wealth ${wealthChange > 0 ? '+ ' : '- '}${Math.abs(wealthChange)} `;
            if (phChange !== 0) statusChangeText += `Physical Health ${phChange > 0 ? '+ ' : '- '}${Math.abs(phChange)} `;
            if (mhChange !== 0) statusChangeText += `Mental Health ${mhChange > 0 ? '+ ' : '- '}${Math.abs(mhChange)}`;
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay12()">CONTINUE</button>
            `;
        }

        function startDay12() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 12';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay12Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay12Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    The recommended delivery route suggested by the platform seems to be rather circuitous. But you know a shortcut.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleShortcut('follow')">
                    Follow the route suggested.
                </button>
                <button class="event-option" onclick="handleShortcut('fast')">
                    Take the shortcut and ride speedily.
                </button>
                <button class="event-option" onclick="handleShortcut('slow')">
                    Take the shortcut but ride slowly.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleShortcut(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let wealthChange = 0;
            let phChange = 0;
            let mhChange = 0;
            
            switch(choice) {
                case 'follow':
                    resultText = "Orders are successfully delivered, though you've been running fast to catch up with time.";
                    break;
                case 'fast':
                    phChange = -5;
                    resultText = "Too bad, the shortcut is blocked. Now you know why the system has suggested a farther route.";
                    break;
                case 'slow':
                    phChange = -5;
                    resultText = "Too bad, the shortcut is blocked. Now you know why the system has suggested a farther route.";
                    break;
            }
            
            // 更新状态显示
            currentWealth += wealthChange;
            currentPH = limitHealthValue(currentPH + phChange);
            currentMH = limitHealthValue(currentMH + mhChange);
            
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            document.getElementById('ph-value').textContent = currentPH + '/100';
            document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
            document.getElementById('mh-value').textContent = currentMH + '/100';
            document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
            
            // 检查游戏是否结束
            if (checkGameOver(currentWealth, currentPH, currentMH)) {
                return;
            }
            
            // 构建状态变化文本
            let statusChangeText = '';
            if (wealthChange !== 0) statusChangeText += `Wealth ${wealthChange > 0 ? '+ ' : '- '}${Math.abs(wealthChange)} `;
            if (phChange !== 0) statusChangeText += `Physical Health ${phChange > 0 ? '+ ' : '- '}${Math.abs(phChange)} `;
            if (mhChange !== 0) statusChangeText += `Mental Health ${mhChange > 0 ? '+ ' : '- '}${Math.abs(mhChange)}`;
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay13()">CONTINUE</button>
            `;
        }

        function startDay13() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 13';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay13Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay13Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            let content = '';
            
            if (selectedEquipment.has('helmet')) {
                content = `
                    <div class="event-text">
                        As you are about to start your vehicle, you realize that you forgot your helmet. With no time to waste, you start delivering orders. Unfortunately, you run into a policeman and get caught not wearing a helmet.
                    </div>
                    <div class="event-question">WHAT DO YOU DO?</div>
                    <button class="event-option" onclick="handleHelmetFine('get')">
                        Pay the fine of ¥150 and go get your helmet from home at the cost of delivering one less order.
                    </button>
                    <button class="event-option" onclick="handleHelmetFine('ignore')">
                        Pay the fine but continue to ignore the traffic laws.
                    </button>
                `;
            } else {
                content = `
                    <div class="event-text">
                        You run into a policeman and get caught not wearing a helmet.
                    </div>
                    <div class="event-question">WHAT DO YOU DO?</div>
                    <button class="event-option" onclick="handleHelmetFine('buy')">
                        Pay the fine of ¥150 and go buy a new helmet immediately.
                    </button>
                    <button class="event-option" onclick="handleHelmetFine('ignore')">
                        Pay the fine but continue to ignore the traffic laws.
                    </button>
                `;
            }
            
            eventContainer.innerHTML = content;
            eventScreen.classList.add('visible');
        }

        function handleHelmetFine(choice) {
            const eventContainer = document.querySelector('.event-container');
            let resultText = '';
            let wealthChange = 0;
            
            if (selectedEquipment.has('helmet')) {
                switch(choice) {
                    case 'get':
                        wealthChange = -155;
                        resultText = "You paid the fine and went back home to get your helmet, but missed one delivery order.";
                        break;
                    case 'ignore':
                        wealthChange = -300;
                        resultText = "Too bad, got caught again by another police, HAHA. You should feel lucky of not getting into a traffic accident.";
                        break;
                }
            } else {
                switch(choice) {
                    case 'buy':
                        wealthChange = -250;
                        resultText = "You paid the fine and bought a new helmet immediately.";
                        break;
                    case 'ignore':
                        wealthChange = -300;
                        resultText = "Too bad, got caught again by another police, HAHA. You should feel lucky of not getting into a traffic accident.";
                        break;
                }
            }
            
            // 更新状态显示
            currentWealth += wealthChange;
            
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            
            // 检查游戏是否结束
            if (checkGameOver(currentWealth, currentPH, currentMH)) {
                return;
            }
            
            // 构建状态变化文本
            let statusChangeText = `Wealth - ${Math.abs(wealthChange)}`;
            
            eventContainer.innerHTML = `
                <div class="event-text">${resultText}</div>
                <div class="event-text" style="color: #90EE90; margin-top: 20px;">${statusChangeText}</div>
                <button class="continue-button" onclick="startDay14()">CONTINUE</button>
            `;
        }

        function startDay14() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 14';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showPayday14();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showPayday14() {
            const paydayScreen = document.createElement('div');
            paydayScreen.className = 'payday-screen';
            const company = localStorage.getItem('company');
            const salary = company === 'meituan' ? 2140 : 2230;
            
            paydayScreen.innerHTML = `
                <div class="payday-text">PAYDAY!</div>
                <div class="payday-amount">Wealth + ${salary}</div>
                <div class="payday-yuan">¥</div>
            `;
            document.body.appendChild(paydayScreen);
            
            // 更新财富值
            currentWealth += salary;
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            
            // 显示payday屏幕
            setTimeout(() => {
                paydayScreen.classList.add('visible');
                
                // 3秒后隐藏payday屏幕并显示day14内容
                setTimeout(() => {
                    paydayScreen.classList.remove('visible');
                    setTimeout(() => {
                        paydayScreen.remove();
                        showDay14Content();
                    }, 500);
                }, 3000);
            }, 100);
        }

        function showDay14Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    Time to pay the electric bill. It costs you around ¥200/month to charge your vehicle.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleElectricBill('pay1')">
                    Pay
                </button>
                <button class="event-option" onclick="handleElectricBill('pay2')">
                    Pay
                </button>
                <button class="event-option" onclick="handleElectricBill('pay3')">
                    Pay
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleElectricBill(choice) {
            const eventContainer = document.querySelector('.event-container');
            const wealthChange = -200;
            
            // 更新状态显示
            currentWealth += wealthChange;
            
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            
            // 检查游戏是否结束
            if (checkGameOver(currentWealth, currentPH, currentMH)) {
                return;
            }
            
            eventContainer.innerHTML = `
                <div class="event-text" style="color: #90EE90;">Wealth - 200</div>
                <button class="continue-button" onclick="startDay15()">CONTINUE</button>
            `;
        }

        function startDay15() {
            console.log('startDay15 called');
            const eventScreen = document.getElementById('event-screen');
            console.log('eventScreen:', eventScreen);
            eventScreen.classList.remove('visible');
            
            // 更新当前天数
            currentDay = 15;
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 15';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            console.log('About to show day 15 content');
                            eventScreen.style.display = 'block';
                            showDay15Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay15Content() {
            console.log('showDay15Content called');
            const eventScreen = document.getElementById('event-screen');
            console.log('eventScreen in showDay15Content:', eventScreen);
            const eventContainer = eventScreen.querySelector('.event-container');
            console.log('eventContainer:', eventContainer);
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    You are introduced to many new features of the delivery platform for the first time:
                    <br><br>
                    1. The tasking system: The dashboard contains many tasks for couriers to choose. For each task completed, the courier would get a bonus and some credits for upgrading.
                    <br><br>
                    2. The upgrading system: When a courier stays active for several consecutive days, their score increases and they level up, from bronze, silver, gold, platinum, all the way to diamond. Couriers also unlock rare clothing and equipment like helmet ornaments (this is where the cute "kangaroo ears" and "bamboo dragonflies" come from). 
                    <br><br>
                    3. The ranking system: Various forms of rankings exist on the platform, with a displayed leaderboard to stimulate couriers' desire to get on the podium: daily order ranking, daily miles ranking, monthly order ranking, monthly miles ranking, and others.
                </div>
                <button class="continue-button" onclick="showDay15Part2()">CONTINUE</button>
            `;
            
            console.log('Content set, about to make screen visible');
            eventScreen.style.display = 'block';
            eventScreen.classList.add('visible');
            console.log('Screen should be visible now');
        }

        function showDay15Part2() {
            const eventContainer = document.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    Just like games, the food delivery platforms are designed with features like tasking, scoring, upgrading, and ranking. Manipulating couriers' desire for higher income, the platforms are designed to motivate the couriers to deliver more orders within less time. Couriers are being oppressed, working in a black box. At the end of the day, food delivery companies want to make more profit, and how? By squeezing their workers. Higher efficiency, but little humanity.
                </div>
                <button class="continue-button" onclick="startDay16()">CONTINUE</button>
            `;
        }

        function showDay16Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    You've been given a task from the system that will get you a bonus, the requirement is to deliver orders for 10 hours straight.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleTaskChoice('receive')">
                    Receive the task.
                </button>
                <button class="event-option" onclick="handleTaskChoice('decline')">
                    Decline the task.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleTaskChoice(choice) {
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'receive') {
                // 更新状态
                currentWealth += 15;
                currentPH -= 10;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">The bonus is not as much as you thought it would be. But you are definitely a lot more exhausted.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth + 15, Physical Health - 10</div>
                    <button class="continue-button" onclick="startDay17()">CONTINUE</button>
                `;
            } else if (choice === 'decline') {
                // 直接进入下一天
                startDay17();
            }
        }

        function startDay17() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 17';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay17Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function startDay16() {
            console.log('startDay16 called');
            const eventScreen = document.getElementById('event-screen');
            console.log('eventScreen:', eventScreen);
            eventScreen.classList.remove('visible');
            
            // 更新当前天数
            currentDay = 16;
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 16';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            console.log('About to show day 16 content');
                            eventScreen.style.display = 'block';
                            showDay16Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay17Content() {
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    You get an order to deliver a birthday cake. You placed it carefully in your box, but your vehicle tripped over a rock on the side of the road. The cake is completely crashed.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleCakeAccident('apologize')">
                    Sincerely apologize to your customer and pay them the total value of the cake. 
                </button>
                <button class="event-option" onclick="handleCakeAccident('fix')">
                    Go back to the merchant and ask them to try to fix the cake. 
                </button>
                <button class="event-option" onclick="handleCakeAccident('ghost')">
                    Ghost your customer because you don't want to deal with the situation. 
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleCakeAccident(choice) {
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'apologize') {
                // 更新状态
                currentWealth -= 200;
                currentMH -= 5;
                
                // 更新显示
                updateWealthDisplay();
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">
                        You've ruined someone's birthday, and you're feeling extremely sorry.
                    </div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 200, Mental Health - 5</div>
                    <button class="continue-button" onclick="startDay18()">CONTINUE</button>
                `;
            } else if (choice === 'fix') {
                // 更新状态
                currentWealth -= 25;
                currentPH -= 5;
                
                // 更新显示
                updateWealthDisplay();
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">
                        Your order is overrun, but luckily the cake is delivered safely. The merchant is being extremely nice by not charging you anything for fixing the cake, they know your work life isn't easy too. To be thankful, you bought them a cup of milk tea.
                    </div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 25, Physical Health - 5</div>
                    <button class="continue-button" onclick="startDay18()">CONTINUE</button>
                `;
            } else if (choice === 'ghost') {
                // 更新状态
                currentWealth -= 215;
                
                // 更新显示
                updateWealthDisplay();
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">
                        Your customer got mad and left you a bad review.
                    </div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 215</div>
                    <button class="continue-button" onclick="startDay18()">CONTINUE</button>
                `;
            }
        }

        function startDay18() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 18';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay18Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay18Content() {
            console.log('showDay18Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            eventContainer.innerHTML = `
                <div class="event-text">
                    Today is a thunderstorm day.
                </div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleThunderstorm('deliver')">
                    Keep delivering food.
                </button>
                <button class="event-option" onclick="handleThunderstorm('rest')">
                    Ask the station manager for a leave.
                </button>
            `;
            
            eventScreen.classList.add('visible');
        }

        function handleThunderstorm(choice) {
            console.log('handleThunderstorm called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'deliver') {
                // 更新状态
                currentWealth += 50;
                currentPH -= 10;
                
                // 更新显示
                updateWealthDisplay();
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">
                        Couriers will not be penalized for overrun orders and will get subsidies for extreme weather that results in almost double the amount they receive for an order on normal days. This is why many of them in fact like to work during days with extreme weather.
                    </div>
                    <div class="event-text" style="color: #90EE90;">Wealth + 50, Physical Health - 10</div>
                    <button class="continue-button" onclick="startDay19()">CONTINUE</button>
                `;
            } else if (choice === 'rest') {
                // 更新状态
                currentWealth -= 200;
                currentPH += 5;
                
                // 更新显示
                updateWealthDisplay();
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">
                        You got a day off but made nothing.
                    </div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 200, Physical Health + 5</div>
                    <button class="continue-button" onclick="startDay19()">CONTINUE</button>
                `;
            }
        }

        function startDay19() {
            console.log('startDay19 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 19';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay19Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay19Content() {
            console.log('showDay19Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">Your customer ordered a malatang (yum yum), but because you're riding too fast, the soup spilled out.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleMalatang('apologize')">Apologize to your customer and eat it yourself.</button>
                <button class="event-option" onclick="handleMalatang('ghost')">Throw the food into the trashcan and not tell anyone.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleMalatang(choice) {
            console.log('handleMalatang called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'apologize') {
                // 更新状态
                currentWealth -= 35;
                currentMH += 5;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You have to report to the platform that the order was unsuccessfully delivered due to your personal reasons and pay the total value of the order to your customer plus a ¥5 fine.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 35, Mental Health + 5</div>
                    <button class="continue-button" onclick="startDay20()">CONTINUE</button>
                `;
            } else if (choice === 'ghost') {
                // 更新状态
                currentWealth -= 45;
                currentMH -= 5;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Half an hour later, your customer called in. You tried to ignore the call and ghost your customer. Your customer got mad and left you a bad review on the system. You got a ¥15 fine and were forced to pay the total value of the order.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 45, Mental Health - 5</div>
                    <button class="continue-button" onclick="startDay20()">CONTINUE</button>
                `;
            }
        }

        function startDay20() {
            console.log('startDay20 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 20';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay20Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay20Content() {
            console.log('showDay20Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">You are currently ranked second on the courier leaderboard of this week, and the first place would get a huge bonus.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleLeaderboard('work')">Work extra hard and try to get to the podium.</button>
                <button class="event-option" onclick="handleLeaderboard('ignore')">No one cares about this leaderboard.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleLeaderboard(choice) {
            console.log('handleLeaderboard called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'work') {
                // 更新状态
                currentPH -= 10;
                currentWealth += 100;
                
                // 更新显示
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You ended up delivering for 12 hours straight and were so exhausted that you could quit the job the next second. Fortunately, hard work paid off and you got to first place.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth + 100,Physical Health - 10</div>
                    <button class="continue-button" onclick="startDay21()">CONTINUE</button>
                `;
            } else if (choice === 'ignore') {
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You decided to maintain your current pace and not push yourself too hard.</div>
                    <button class="continue-button" onclick="startDay21()">CONTINUE</button>
                `;
            }
        }

        function startDay21() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 21';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showPayday21();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showPayday21() {
            const paydayScreen = document.createElement('div');
            paydayScreen.className = 'payday-screen';
            const company = localStorage.getItem('company');
            const salary = company === 'meituan' ? 2140 : 2230;
            
            paydayScreen.innerHTML = `
                <div class="payday-text">PAYDAY!</div>
                <div class="payday-amount">Wealth + ${salary}</div>
                <div class="payday-yuan">¥</div>
            `;
            document.body.appendChild(paydayScreen);
            
            // 更新财富值
            currentWealth += salary;
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            
            // 显示payday屏幕
            setTimeout(() => {
                paydayScreen.classList.add('visible');
                
                // 3秒后隐藏payday屏幕并显示day21内容
                setTimeout(() => {
                    paydayScreen.classList.remove('visible');
                    setTimeout(() => {
                        paydayScreen.remove();
                        showDay21Content();
                    }, 500);
                }, 3000);
            }, 100);
        }

        function showDay21Content() {
            console.log('showDay21Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">Riding down the road, your vehicle hits a nail, and the tire leaks.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleFlatTire('fix')">Get it fixed.</button>
                <button class="event-option" onclick="handleFlatTire('ignore')">Ignore it and keep riding.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleFlatTire(choice) {
            console.log('handleFlatTire called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'fix') {
                // 更新状态
                currentWealth -= 300;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You got your tire fixed immediately.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 300</div>
                    <button class="continue-button" onclick="startDay22()">CONTINUE</button>
                `;
            } else if (choice === 'ignore') {
                // 更新状态
                currentWealth -= 310;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Your vehicle is moving extremely slowly because of the flat tire. Two of your orders are overrun. You have no choice but to fix it.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 310</div>
                    <button class="continue-button" onclick="startDay22()">CONTINUE</button>
                `;
            }
        }

        function startDay22() {
            console.log('startDay22 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 22';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay22Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay22Content() {
            console.log('showDay22Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">When you finally arrived at the customer's address, no one answered the door. You called your customer, and it turns out that they put the wrong address. Your customer threatened you with a horrible attitude to deliver the order immediately to the new address that is miles away. However, you still have several other orders that have not been delivered yet.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleWrongAddress('explain')">Explain calmly that you cannot deliver to a different address and ask them to reorder.</button>
                <button class="event-option" onclick="handleWrongAddress('agree')">Agree to deliver to the new address immediately.</button>
                <button class="event-option" onclick="handleWrongAddress('refuse')">Refuse and cancel the order right away.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleWrongAddress(choice) {
            console.log('handleWrongAddress called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'explain') {
                // 更新状态
                currentMH -= 5;
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You lose this order, but you protect your time and other orders. The customer leaves an angry review, but the platform sides with you.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 5</div>
                    <button class="continue-button" onclick="startDay23()">CONTINUE</button>
                `;
            } else if (choice === 'agree') {
                // 更新状态
                currentWealth -= 10;
                currentPH -= 5;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You save this customer's order, but your other deliveries are delayed, and you get penalized for lateness.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 10, Physical Health - 5</div>
                    <button class="continue-button" onclick="startDay23()">CONTINUE</button>
                `;
            } else if (choice === 'refuse') {
                // 更新状态
                currentWealth -= 5;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You refused to deliver to the new address and canceled the order.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 5</div>
                    <button class="continue-button" onclick="startDay23()">CONTINUE</button>
                `;
            }
        }

        function startDay23() {
            console.log('startDay23 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 23';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay23Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay23Content() {
            console.log('showDay23Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">Riding down the street, you see a phone ringing on the ground. You picked up the call, the caller explained that their phone was lost and asked whether you could deliver the phone to them.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleLostPhone('ignore')">Ignore it.</button>
                <button class="event-option" onclick="handleLostPhone('keep')">Keep the phone for yourself.</button>
                <button class="event-option" onclick="handleLostPhone('deliver')">Deliver the phone to them.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleLostPhone(choice) {
            console.log('handleLostPhone called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'ignore') {
                // 更新状态
                currentMH -= 10;
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You avoid the hassle, but guilt nags at you for the rest of the day.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 10</div>
                    <button class="continue-button" onclick="startDay24()">CONTINUE</button>
                `;
            } else if (choice === 'keep') {
                // 更新状态
                currentMH -= 20;
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You have a new phone, but you feel terrible—and you risk getting banned if you're caught.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 20</div>
                    <button class="continue-button" onclick="startDay24()">CONTINUE</button>
                `;
            } else if (choice === 'deliver') {
                // 更新状态
                currentWealth += 100;
                currentPH -= 5;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">The owner of the phone is very thankful and insists on transferring ¥100 yuan as a token of their gratitude.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth + 100, Physical Health - 5 </div>
                    <button class="continue-button" onclick="startDay24()">CONTINUE</button>
                `;
            }
        }

        function startDay24() {
            console.log('startDay24 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 24';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay24Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay24Content() {
            console.log('showDay24Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">Your customer left a note requesting you to get a package on your way to the apartment or else they will give you a bad review.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handlePackageRequest('get')">Get the package.</button>
                <button class="event-option" onclick="handlePackageRequest('refuse')">Show up at the door without the package, and claim that you don't have the responsibility to help them with an additional errand.</button>
                <button class="event-option" onclick="handlePackageRequest('pretend')">Pretend you did not see the note and show up at the door without the package. When confronted, explain that it was not intentional.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handlePackageRequest(choice) {
            console.log('handlePackageRequest called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'get') {
                // 更新状态
                currentPH -= 5;
                
                // 更新显示
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Delivering the food is already tiring, completing these requests just made your life even harder.</div>
                    <div class="event-text" style="color: #90EE90;">Physical Health - 5</div>
                    <button class="continue-button" onclick="startDay25()">CONTINUE</button>
                `;
            } else if (choice === 'refuse') {
                // 更新状态
                currentWealth -= 5;
                currentMH -= 5;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Your customer got mad and left you a bad review that costs you a ¥5 fine.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 5, Mental Health - 5</div>
                    <button class="continue-button" onclick="startDay25()">CONTINUE</button>
                `;
            } else if (choice === 'pretend') {
                // 更新状态
                currentMH -= 5;
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Your customer questioned the explanation, but still closed the door without asking for clarification.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 5</div>
                    <button class="continue-button" onclick="startDay25()">CONTINUE</button>
                `;
            }
        }

        function startDay25() {
            console.log('startDay25 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 25';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay25Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay25Content() {
            console.log('showDay25Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">Your parents call in, asking you to come home because they're feeling sick and alone.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleParentsCall('rush')">Drop everything and rush home immediately.</button>
                <button class="event-option" onclick="handleParentsCall('calm')">Calm them down over the phone and promise to come home as soon as you finish delivering all orders.</button>
                <button class="event-option" onclick="handleParentsCall('ignore')">Ignore the call and keep delivering.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleParentsCall(choice) {
            console.log('handleParentsCall called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'rush') {
                // 更新状态
                currentWealth -= 100;
                currentMH = limitHealthValue(currentMH + 10);
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Family comes first, but your unfinished orders are canceled automatically.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 100, Mental Health + 10</div>
                    <button class="continue-button" onclick="startDay26()">CONTINUE</button>
                `;
            } else if (choice === 'calm') {
                // 更新状态
                currentMH = limitHealthValue(currentMH - 10);
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You manage to keep working, but guilt weighs heavily on you.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 10</div>
                    <button class="continue-button" onclick="startDay26()">CONTINUE</button>
                `;
            } else if (choice === 'ignore') {
                // 更新状态
                currentMH = limitHealthValue(currentMH - 20);
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You feel like a terrible person, and your parents are deeply upset.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 20</div>
                    <button class="continue-button" onclick="startDay26()">CONTINUE</button>
                `;
            }
        }

        function startDay26() {
            console.log('startDay26 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 26';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay26Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay26Content() {
            console.log('showDay26Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">When you deliver an order to an office, the customer unexpectedly gives you a generous tip.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleTip('treat')">Thank them warmly and treat yourself to a good meal later.</button>
                <button class="event-option" onclick="handleTip('save')">Save the tip strictly for rent.</button>
                <button class="event-option" onclick="handleTip('lottery')">Spend the tip on a scratch-off lottery ticket.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleTip(choice) {
            console.log('handleTip called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'treat') {
                // 更新状态
                currentWealth += 50;
                currentMH = limitHealthValue(currentMH + 5);
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Small joys make life better.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth + 50, Mental Health + 5</div>
                    <button class="continue-button" onclick="startDay27()">CONTINUE</button>
                `;
            } else if (choice === 'save') {
                // 更新状态
                currentWealth += 50;
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Adulting is tough but crucial.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth + 50</div>
                    <button class="continue-button" onclick="startDay27()">CONTINUE</button>
                `;
            } else if (choice === 'lottery') {
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You lose, of course.</div>
                    <button class="continue-button" onclick="startDay27()">CONTINUE</button>
                `;
            }
        }

        function startDay27() {
            console.log('startDay27 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 27';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay27Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay27Content() {
            console.log('showDay27Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">Your best friend, who's also a courier, calls you in a panic. They got into a minor accident and their phone is dead—they need help picking up their unfinished deliveries or they'll get suspended. But, you're already behind on your own orders.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleFriendCall('help')">Drop your deliveries and help them immediately.</button>
                <button class="event-option" onclick="handleFriendCall('finish')">Finish your orders first and then check on them.</button>
                <button class="event-option" onclick="handleFriendCall('ignore')">Ignore the call—they'll figure something out.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleFriendCall(choice) {
            console.log('handleFriendCall called with choice:', choice);
            const eventContainer = document.querySelector('.event-container');
            
            if (choice === 'help') {
                // 更新状态
                currentWealth -= 50;
                currentPH = limitHealthValue(currentPH - 5);
                currentMH = limitHealthValue(currentMH + 5);
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">You save their job but lose serious money yourself.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 50, Physical Health - 5, Mental Health + 5</div>
                    <button class="continue-button" onclick="startDay28()">CONTINUE</button>
                `;
            } else if (choice === 'finish') {
                // 更新状态
                currentMH = limitHealthValue(currentMH - 5);
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">By the time you get there, they've already been suspended. Now you feel like a terrible friend.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 5</div>
                    <button class="continue-button" onclick="startDay28()">CONTINUE</button>
                `;
            } else if (choice === 'ignore') {
                // 更新状态
                currentMH = limitHealthValue(currentMH - 10);
                
                // 更新显示
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Friendship takes a hit.</div>
                    <div class="event-text" style="color: #90EE90;">Mental Health - 10</div>
                    <button class="continue-button" onclick="startDay28()">CONTINUE</button>
                `;
            }
        }

        function startDay28() {
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 28';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showPayday28();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showPayday28() {
            const paydayScreen = document.createElement('div');
            paydayScreen.className = 'payday-screen';
            const company = localStorage.getItem('company');
            const salary = company === 'meituan' ? 2140 : 2230;
            
            paydayScreen.innerHTML = `
                <div class="payday-text">PAYDAY!</div>
                <div class="payday-amount">Wealth + ${salary}</div>
                <div class="payday-yuan">¥</div>
            `;
            document.body.appendChild(paydayScreen);
            
            // 更新财富值
            currentWealth += salary;
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            
            // 显示payday屏幕
            setTimeout(() => {
                paydayScreen.classList.add('visible');
                
                // 3秒后隐藏payday屏幕并显示day28内容
                setTimeout(() => {
                    paydayScreen.classList.remove('visible');
                    setTimeout(() => {
                        paydayScreen.remove();
                        showDay28Content();
                    }, 500);
                }, 3000);
            }, 100);
        }

        function showDay28Content() {
            console.log('showDay28Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="event-text">EMERGENCY! You run into a serious traffic accident. Your vehicle smashed into your leg, causing a fracture.</div>
                <div class="event-question">WHAT DO YOU DO?</div>
                <button class="event-option" onclick="handleAccident()">Go to the hospital for a check-up and following treatments.</button>
            `;
            eventScreen.classList.add('visible');
        }

        function handleAccident() {
            console.log('handleAccident called');
            const eventContainer = document.querySelector('.event-container');
            
            // 检查玩家在DAY 4的选择
            const socialSecurityChoice = localStorage.getItem('socialSecurityChoice');
            
            if (socialSecurityChoice === 'pay') {
                // 更新状态
                currentWealth -= 3000;
                currentPH = limitHealthValue(currentPH - 30);
                currentMH = limitHealthValue(currentMH - 10);
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Thanks to the social security that you purchased.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 3000, Physical Health - 30, Mental Health - 10</div>
                    <button class="continue-button" onclick="startDay29()">CONTINUE</button>
                `;
            } else {
                // 更新状态
                currentWealth -= 5000;
                currentPH = limitHealthValue(currentPH - 30);
                currentMH = limitHealthValue(currentMH - 10);
                
                // 更新显示
                document.getElementById('wealth-value').textContent = currentWealth;
                // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
                document.getElementById('ph-value').textContent = currentPH + '/100';
                document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
                document.getElementById('mh-value').textContent = currentMH + '/100';
                document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
                
                // 检查游戏是否结束
                if (checkGameOver(currentWealth, currentPH, currentMH)) {
                    return;
                }
                
                // 显示结果
                eventContainer.innerHTML = `
                    <div class="event-text">Feels like the end of the world right? That's the consequence of not paying for social security.</div>
                    <div class="event-text" style="color: #90EE90;">Wealth - 5000, Physical Health - 30, Mental Health - 10</div>
                    <button class="continue-button" onclick="startDay29()">CONTINUE</button>
                `;
            }
        }

        function startDay29() {
            console.log('startDay29 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 29';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay29Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay29Content() {
            console.log('showDay29Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            // 更新状态
            currentWealth -= 200;
            currentPH = limitHealthValue(currentPH + 5);
            currentMH = limitHealthValue(currentMH + 5);
            
            // 更新显示
            document.getElementById('wealth-value').textContent = currentWealth;
            // document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
            document.getElementById('ph-value').textContent = currentPH + '/100';
            document.getElementById('ph-bar').style.width = (currentPH / 100 * 100) + '%';
            document.getElementById('mh-value').textContent = currentMH + '/100';
            document.getElementById('mh-bar').style.width = (currentMH / 100 * 100) + '%';
            
            // 检查游戏是否结束
            if (checkGameOver(currentWealth, currentPH, currentMH)) {
                return;
            }
            
            eventContainer.innerHTML = `
                <div class="event-text">Because of your fractured leg,</div>
                <div class="event-text">you are forced to take a day off...</div>
                <div class="event-text" style="color: #90EE90;">Wealth - 200, Physical Health + 5, Mental Health + 5</div>
                <button class="continue-button" onclick="startDay30()">CONTINUE</button>
            `;
            eventScreen.classList.add('visible');
        }

        function startDay30() {
            console.log('startDay30 called');
            const eventScreen = document.getElementById('event-screen');
            eventScreen.classList.remove('visible');
            
            setTimeout(() => {
                const dayScreen = document.getElementById('day-screen');
                const dayNumber = dayScreen.querySelector('.day-number');
                dayNumber.textContent = 'DAY 30';
                
                dayScreen.classList.add('visible');
                setTimeout(() => {
                    dayNumber.classList.add('visible');
                    
                    setTimeout(() => {
                        dayNumber.classList.remove('visible');
                        setTimeout(() => {
                            dayScreen.classList.remove('visible');
                            showDay30Content();
                        }, 500);
                    }, 1500);
                }, 100);
            }, 500);

            // 更新日历
            const currentDayElement = document.querySelector('.calendar-day.current');
            if (currentDayElement) {
                currentDayElement.classList.remove('current');
                const nextDayElement = currentDayElement.nextElementSibling;
                if (nextDayElement) {
                    nextDayElement.classList.add('current');
                }
            }
        }

        function showDay30Content() {
            console.log('showDay30Content called');
            const eventScreen = document.getElementById('event-screen');
            const eventContainer = eventScreen.querySelector('.event-container');
            
            // 创建统计信息容器
            eventContainer.innerHTML = `
                <div class="summary-title">Summary</div>
                <div class="stat-container">
                    <div class="stat-item" id="wealth-stat">
                        <span class="stat-label">Wealth:</span>
                        <span class="stat-value">${currentWealth}</span>
                    </div>
                    <div class="stat-item" id="ph-stat">
                        <span class="stat-label">Physical Health:</span>
                        <span class="stat-value">${currentPH}/100</span>
                    </div>
                    <div class="stat-item" id="mh-stat">
                        <span class="stat-label">Mental Health:</span>
                        <span class="stat-value">${currentMH}/100</span>
                    </div>
                </div>
            `;
            
            eventScreen.classList.add('visible');
            
            // 添加动画效果
            setTimeout(() => {
                document.getElementById('wealth-stat').classList.add('visible');
                setTimeout(() => {
                    document.getElementById('ph-stat').classList.add('visible');
                    setTimeout(() => {
                        document.getElementById('mh-stat').classList.add('visible');
                        setTimeout(() => {
                            showEndingMessage();
                        }, 3000);
                    }, 500);
                }, 500);
            }, 500);
        }

        function showEndingMessage() {
            const eventContainer = document.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="ending-content">
                    <div class="event-text" style="font-size: 24px; margin-bottom: 30px;">CONGRATULATIONS!</div>
                    <div class="event-text">
                        You've made it through. You managed to survive a month of hustle, exhaustion, and emotional strain of life as a food delivery courier. It wasn't easy. Balancing your finances, your health, and your mind demanded every bit of strategy and sacrifice. This game now comes to an end, but for many, the daily grind doesn't. Behind every delivery is someone working through hunger, fatigue, and poverty under capitalistic control. So, as consumers, let's remember to show more patience, empathy, and respect for the people who make our convenience possible.
                    </div>
                    <div class="event-text" style="margin-top: 20px;">
                        Thank you for playing LIFE.
                    </div>
                    <button class="continue-button" onclick="showCredits()" style="margin-top: 30px;">CONTINUE</button>
                </div>
            `;

            // 添加淡入动画
            setTimeout(() => {
                document.querySelector('.ending-content').classList.add('visible');
            }, 100);
        }

        function showCredits() {
            const eventContainer = document.querySelector('.event-container');
            eventContainer.innerHTML = `
                <div class="credits-container" style="position: relative; left: 0; right: 0; display: flex; flex-direction: column; align-items: center; margin-top: 50px; padding-bottom: 100px; height: auto;">
                    <div class="credits-row spacer" style="height: 30px;"></div>
                    <div class="credits-row" id="credit-row-1" style="display: flex; width: 100%; max-width: 1100px; margin-bottom: 40px; padding: 0 20px; font-size: 28px; opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease;">
                        <div class="credits-label" style="flex: 1; text-align: left; font-weight: bold; padding-right: 40px;">Made by</div>
                        <div class="credits-value" style="flex: 2; text-align: left;">Susan Zheng</div>
                    </div>
                    <div class="credits-row" id="credit-row-2" style="display: flex; width: 100%; max-width: 1100px; margin-bottom: 40px; padding: 0 20px; font-size: 28px; opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease;">
                        <div class="credits-label" style="flex: 1; text-align: left; font-weight: bold; padding-right: 40px;">Special thanks</div>
                        <div class="credits-value" style="flex: 2; text-align: left;">Jack Porter</div>
                    </div>
                    <div class="credits-row" id="credit-row-3" style="display: flex; width: 100%; max-width: 1100px; margin-bottom: 40px; padding: 0 20px; font-size: 28px; opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease;">
                        <div class="credits-label" style="flex: 1; text-align: left; font-weight: bold; padding-right: 40px;">Development tool</div>
                        <div class="credits-value" style="flex: 2; text-align: left;">Cursor</div>
                    </div>
                    <div class="credits-row" id="credit-row-4" style="display: flex; width: 100%; max-width: 1100px; margin-bottom: 40px; padding: 0 20px; font-size: 28px; opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease, transform 0.5s ease;">
                        <div class="credits-label" style="flex: 1; text-align: left; font-weight: bold; padding-right: 40px;">Soundtrack</div>
                        <div class="credits-value" style="flex: 2; text-align: left;">Tarrey Town - The Legend of Zelda: Breath of the Wild</div>
                    </div>
                    <div class="credits-row spacer" style="height: 30px;"></div>
                    <button class="continue-button play-again-button" onclick="location.reload()" style="opacity: 0; transition: opacity 0.5s ease; margin-top: 30px; position: relative; z-index: 100;">PLAY AGAIN</button>
                </div>
            `;

            // 逐行显示credits
            setTimeout(() => {
                document.getElementById('credit-row-1').style.opacity = '1';
                document.getElementById('credit-row-1').style.transform = 'translateY(0)';
                
                setTimeout(() => {
                    document.getElementById('credit-row-2').style.opacity = '1';
                    document.getElementById('credit-row-2').style.transform = 'translateY(0)';
                    
                    setTimeout(() => {
                        document.getElementById('credit-row-3').style.opacity = '1';
                        document.getElementById('credit-row-3').style.transform = 'translateY(0)';
                        
                        setTimeout(() => {
                            document.getElementById('credit-row-4').style.opacity = '1';
                            document.getElementById('credit-row-4').style.transform = 'translateY(0)';
                            
                            // 最后显示Play Again按钮
                            setTimeout(() => {
                                document.querySelector('.play-again-button').style.opacity = '1';
                            }, 1000);
                        }, 1000);
                    }, 1000);
                }, 1000);
            }, 500);
        }

        // 修改wealth显示的函数
        function updateWealth() {
            // 更新wealth值
            document.getElementById('wealth-value').textContent = currentWealth;
            // 更新进度条
            document.getElementById('wealth-bar').style.width = (currentWealth / 20000 * 100) + '%';
        }

        // 添加音频控制函数
        function playBackgroundMusic() {
            const bgMusic = document.getElementById('bgMusic');
            bgMusic.volume = 0.3; // 设置音量
            bgMusic.play().catch(error => {
                console.log('自动播放被阻止，需要用户交互后播放');
            });
        }

        // 添加暂停/播放控制
        function toggleMusic() {
            const bgMusic = document.getElementById('bgMusic');
            if (bgMusic.paused) {
                bgMusic.play();
            } else {
                bgMusic.pause();
            }
        }

        // 在游戏界面添加音乐控制按钮
        function addMusicControl() {
            const musicButton = document.createElement('button');
            musicButton.className = 'music-control';
            musicButton.innerHTML = '🔊';
            musicButton.onclick = toggleMusic;
            document.body.appendChild(musicButton);
        }

        // 在游戏初始化时调用
        window.onload = function() {
            addMusicControl();
            // addDebugControls(); // 删除测试按钮
            
            // 添加测试按钮（隐藏）
            addBlinkTestButton();
            
            // 启动闪烁效果检查器（每隔250毫秒检查一次）
            setInterval(checkBlinkEffects, 250);
            
            // 在页面加载完成3秒后，开始检查是否游戏结束并应用闪烁效果
            setTimeout(function() {
                if (isGameOver()) {
                    if (currentWealth !== undefined && currentWealth <= 0) {
                        window.forceValueBlink('wealth');
                    } else if (currentPH !== undefined && currentPH <= 0) {
                        window.forceValueBlink('ph');
                    } else if (currentMH !== undefined && currentMH <= 0) {
                        window.forceValueBlink('mh');
                    }
                }
            }, 3000);
        }
        
        // 添加一个测试闪烁效果的按钮
        function addBlinkTestButton() {
            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 999999;
                display: flex;
                flex-direction: column;
                gap: 5px;
            `;
            
            // 创建测试财富按钮
            const wealthButton = document.createElement('button');
            wealthButton.textContent = '测试财富闪烁';
            wealthButton.style.cssText = `
                background-color: #FFD700;
                color: black;
                border: none;
                padding: 5px 10px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 12px;
                opacity: 0.7;
            `;
            
            wealthButton.addEventListener('click', function() {
                window.forceValueBlink('wealth');
            });
            
            // 创建测试体力按钮
            const phButton = document.createElement('button');
            phButton.textContent = '测试体力闪烁';
            phButton.style.cssText = `
                background-color: #9C27B0;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 12px;
                opacity: 0.7;
            `;
            
            phButton.addEventListener('click', function() {
                window.forceValueBlink('ph');
            });
            
            // 创建测试精神按钮
            const mhButton = document.createElement('button');
            mhButton.textContent = '测试精神闪烁';
            mhButton.style.cssText = `
                background-color: #F44336;
                color: white;
                border: none;
                padding: 5px 10px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 12px;
                opacity: 0.7;
            `;
            
            mhButton.addEventListener('click', function() {
                window.forceValueBlink('mh');
            });
            
            // 添加按钮到容器
            buttonContainer.appendChild(wealthButton);
            buttonContainer.appendChild(phButton);
            buttonContainer.appendChild(mhButton);
            
            // 添加到文档中，但默认隐藏
            buttonContainer.style.display = 'none';
            document.body.appendChild(buttonContainer);
            
            // 添加键盘快捷键(Alt+B)显示测试按钮
            document.addEventListener('keydown', function(e) {
                if (e.altKey && e.key === 'b') {
                    buttonContainer.style.display = buttonContainer.style.display === 'none' ? 'flex' : 'none';
                }
            });
        }
        
        // 检查是否需要应用闪烁效果
        function checkBlinkEffects() {
            // 只有在游戏结束条件满足时才应用闪烁效果
            if (isGameOver()) {
                console.log("游戏已结束，检查需要闪烁的指标");
                
                // 检查财富是否为零或负数
                if (currentWealth !== undefined && currentWealth <= 0) {
                    console.log("检测到财富归零，应用闪烁效果");
                    window.forceValueBlink('wealth');
                    return; // 只应用一种闪烁效果
                }
                
                // 检查体力是否为零
                if (currentPH !== undefined && currentPH <= 0) {
                    console.log("检测到体力归零，应用闪烁效果");
                    window.forceValueBlink('ph');
                    return;
                }
                
                // 检查精神是否为零
                if (currentMH !== undefined && currentMH <= 0) {
                    console.log("检测到精神归零，应用闪烁效果");
                    window.forceValueBlink('mh');
                    return;
                }
            }
        }
        
        // 判断游戏是否已结束
        function isGameOver() {
            // 检查是否存在游戏结束屏幕
            const gameOverScreens = document.querySelectorAll('div[style*="background-color: rgba(0, 0, 0, 0.9)"][style*="z-index: 999999"]');
            if (gameOverScreens && gameOverScreens.length > 0) {
                return true;
            }
            
            // 检查游戏结束条件
            if (currentWealth !== undefined && currentWealth <= 0) return true;
            if (currentPH !== undefined && currentPH <= 0) return true;
            if (currentMH !== undefined && currentMH <= 0) return true;
            
            return false;
        }

        // 添加调试控件
        function addDebugControls() {
            const debugContainer = document.createElement('div');
            debugContainer.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 20px;
                z-index: 99999;
                display: flex;
                flex-direction: column;
                gap: 10px;
            `;
            
            // 创建测试按钮
            const testButton = document.createElement('button');
            testButton.textContent = '测试游戏结束';
            testButton.style.cssText = `
                background-color: #ff5722;
                color: white;
                border: none;
                padding: 10px;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
                opacity: 0.5;
            `;
            
            testButton.addEventListener('mouseover', function() {
                this.style.opacity = '1';
            });
            
            testButton.addEventListener('mouseout', function() {
                this.style.opacity = '0.5';
            });
            
            testButton.addEventListener('click', function() {
                testGameOver();
            });
            
            debugContainer.appendChild(testButton);
            document.body.appendChild(debugContainer);
        }

        function showGameOver(message) {
            const gameOverScreen = document.querySelector('.game-over-screen');
            const gameOverMessage = document.querySelector('.game-over-message');
            
            if (gameOverScreen && gameOverMessage) {
                gameOverMessage.textContent = message;
                gameOverScreen.classList.add('visible');
                
                // 确保所有元素都可见
                const gameOverText = gameOverScreen.querySelector('.game-over-text');
                const playAgainButton = gameOverScreen.querySelector('.play-again-button');
                
                if (gameOverText) {
                    gameOverText.style.display = 'block';
                }
                if (playAgainButton) {
                    playAgainButton.style.display = 'block';
                }
            }
        }

        // 添加一个测试函数，用于手动触发游戏结束状态
        function testGameOver(condition) {
            console.log("测试游戏结束功能...");
            
            // 如果没有传入条件，则可能是手动测试，需要设置默认值
            if (!condition) {
                condition = 'wealth'; // 默认测试财富归零
            }
            
            // 1. 先设置对应值为零并闪烁，但不立即显示游戏结束界面
            if (condition === 'wealth') {
                currentWealth = -1;
                console.log("测试：财富归零");
            } else if (condition === 'ph') {
                currentPH = 0;
                console.log("测试：体力归零");
            } else if (condition === 'mh') {
                currentMH = 0;
                console.log("测试：精神归零");
            }
            
            // 2. 立即应用闪烁效果
            window.forceValueBlink(condition);
            
            // 检查是否已经有倒计时在进行
            const existingCountdown = document.getElementById('game-over-countdown');
            if (!existingCountdown) {
                // 3. 延迟1.5秒后才显示游戏结束界面
                console.log("延迟1.5秒后显示游戏结束界面");
                
                // 显示提示信息
                showGameOverCountdown(1.5, condition);
                
                setTimeout(function() {
                    // 4. 显示游戏结束界面
                    displayFullGameOverScreen(condition);
                }, 1500);
            } else {
                // 已经有倒计时，说明是从checkGameOver调用的，直接显示游戏结束界面
                displayFullGameOverScreen(condition);
            }
        }
        
        // 显示游戏结束倒计时提示（简化版，不再显示视觉效果）
        function showGameOverCountdown(seconds, condition) {
            // 简化为仅输出日志，不再显示醒目的倒计时提示
            console.log(`游戏将在${seconds}秒后结束，条件: ${condition}`);
        }

        // 添加一个新的显示游戏结束界面的函数
        function displayFullGameOverScreen(condition) {
            console.log("显示完整游戏结束界面，条件:", condition);
            
            // 添加debug模式
            const debugMode = true; // 设置为true开启调试功能
            if (debugMode) {
                console.log('DEBUG模式已开启');
                console.log('当前状态:', { 
                    '财富': currentWealth, 
                    '体力': currentPH, 
                    '精神健康': currentMH,
                    '日期': currentDay
                });
            }
            
            // 防止多次调用，清除所有计时器
            for (let i = 1; i < 10000; i++) {
                window.clearTimeout(i);
                window.clearInterval(i);
            }
            
            // 移除可能干扰的元素
            try {
                const elementsToHide = [
                    '.game-over-screen',
                    '.event-screen',
                    '.day-screen',
                    '.result-screen',
                    '.payday-screen',
                    '.newspaper-screen',
                    '.transition-sequence',
                    '.info-screen'
                ];
                
                elementsToHide.forEach(selector => {
                    const elements = document.querySelectorAll(selector);
                    if (elements.length > 0) {
                        elements.forEach(el => {
                            el.style.display = 'none';
                            el.style.opacity = '0';
                            el.style.pointerEvents = 'none';
                        });
                        console.log(`已隐藏元素: ${selector}`);
                    }
                });
            } catch (error) {
                console.error('隐藏元素时出错:', error);
            }
            
            // 使用最简单直接的方式创建游戏结束界面
            const overlay = document.createElement('div');
            
            // 设置样式 - 使用最基本的内联样式
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.9);
                z-index: 999999;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                font-family: Arial, sans-serif;
            `;
            
            // 创建游戏结束文本
            let message = "这是一条测试游戏结束消息，您可以看到游戏结束界面是否正常显示。";
            let zeroValueColor = "#FF0000"; // 默认红色
            
            if (condition === 'wealth') {
                currentWealth = -1;
                message = "Your wallet's empty, and the bills haven't stopped coming. No matter how many hours you worked, it just wasn't enough. In this world, survival costs more than effort—it costs everything.";
                zeroValueColor = "#FFD700"; // 财富为金黄色
            } else if (condition === 'ph') {
                currentPH = 0;
                message = "Your body finally gave up. The long hours, skipped meals, and constant exhaustion took their toll. You couldn't push through anymore—even if you wanted to. When your body is your only tool, giving out means the end of the road.";
                zeroValueColor = "#9C27B0"; // 体力为紫色
            } else if (condition === 'mh') {
                currentMH = 0;
                message = "You feel numb. The pressure, isolation, and uncertainty wore you down until there was nothing left. You tried to keep going, but even the strongest willpower has its limits. Some things can't be fixed with a paycheck.";
                zeroValueColor = "#F44336"; // 精神为红色
            }
            
            // 游戏结束文本HTML
            overlay.innerHTML = `
                <div style="color: #FF0000; font-size: 120px; margin-bottom: 40px; text-shadow: 0 0 20px #FF0000;">GAME OVER</div>
                <div style="color: #FFFFFF; font-size: 24px; max-width: 80%; text-align: center; margin-bottom: 40px; line-height: 1.5;">${message}</div>
                <button id="restart-button" style="background-color: #4CAF50; color: white; border: none; padding: 15px 30px; font-size: 24px; border-radius: 5px; cursor: pointer;">PLAY AGAIN</button>
            `;
            
            // 添加到body
            document.body.appendChild(overlay);
            
            try {
                // 添加事件监听
                const restartButton = document.getElementById('restart-button');
                if (restartButton) {
                    restartButton.addEventListener('click', function() {
                        location.reload();
                    });
                    
                    // 添加按钮悬停效果
                    restartButton.addEventListener('mouseover', function() {
                        this.style.backgroundColor = '#45a049';
                        this.style.transform = 'scale(1.05)';
                        this.style.boxShadow = '0 0 10px rgba(255, 255, 255, 0.5)';
                    });
                    restartButton.addEventListener('mouseout', function() {
                        this.style.backgroundColor = '#4CAF50';
                        this.style.transform = 'scale(1)';
                        this.style.boxShadow = 'none';
                    });
                } else {
                    console.error('无法找到重新开始按钮!');
                }
            } catch (btnError) {
                console.error('设置按钮事件时出错:', btnError);
            }
            
            // 再次确保闪烁效果生效
            window.forceValueBlink(condition);
            
            // 阻止其他点击并禁用所有按钮
            try {
                overlay.addEventListener('click', function(e) {
                    if (e.target === overlay) {
                        e.stopPropagation();
                    }
                });
                
                const allButtons = document.querySelectorAll('button:not(#restart-button)');
                allButtons.forEach(button => {
                    button.disabled = true;
                    button.style.pointerEvents = 'none';
                });
            } catch (eventError) {
                console.error('设置事件拦截时出错:', eventError);
            }
            
            // 强制显示游戏结束界面
            setTimeout(() => {
                try {
                    overlay.style.opacity = '1';
                    console.log('游戏结束界面显示完成');
                    
                    // 最后一次尝试应用闪烁效果
                    setTimeout(() => {
                        window.forceValueBlink(condition);
                        
                        // 持续尝试应用闪烁效果，确保在用户互动期间闪烁效果持续生效
                        const blinkCheckIntervalId = setInterval(() => {
                            if (isGameOver()) {
                                window.forceValueBlink(condition);
                            } else {
                                clearInterval(blinkCheckIntervalId);
                            }
                        }, 1000);
                    }, 500);
                } catch (finalError) {
                    console.error('最终显示游戏结束界面时出错:', finalError);
                }
            }, 100);
            
            return true; // 确保返回值为true
        }

        // 修改原有的checkGameOver函数，使用新的简化方法
        function checkGameOver(wealth, ph, mh) {
            if (wealth < 0 || ph <= 0 || mh <= 0) {
                console.log("游戏结束条件触发: ", {wealth, ph, mh});
                
                let condition = '';
                
                // 确定游戏结束原因并立即应用闪烁效果
                if (wealth < 0) {
                    condition = 'wealth';
                    try {
                        const wealthValue = document.getElementById('wealth-value');
                        if (wealthValue) {
                            wealthValue.textContent = '0';
                            wealthValue.style.color = "#FFD700"; // 财富为金黄色
                            window.forceValueBlink('wealth');
                            console.log('checkGameOver: 财富值应用闪烁效果');
                        }
                    } catch (err) {
                        console.error('设置财富闪烁效果时出错:', err);
                    }
                } else if (ph <= 0) {
                    condition = 'ph';
                    try {
                        const phValue = document.getElementById('ph-value');
                        if (phValue) {
                            phValue.textContent = '0/100';
                            phValue.style.color = "#9C27B0"; // 体力为紫色
                            window.forceValueBlink('ph');
                            console.log('checkGameOver: 体力值应用闪烁效果');
                        }
                    } catch (err) {
                        console.error('设置体力闪烁效果时出错:', err);
                    }
                } else if (mh <= 0) {
                    condition = 'mh';
                    try {
                        const mhValue = document.getElementById('mh-value');
                        if (mhValue) {
                            mhValue.textContent = '0/100';
                            mhValue.style.color = "#F44336"; // 精神为红色
                            window.forceValueBlink('mh');
                            console.log('checkGameOver: 精神值应用闪烁效果');
                        }
                    } catch (err) {
                        console.error('设置精神闪烁效果时出错:', err);
                    }
                }
                
                // 延迟调用游戏结束函数，让闪烁效果先展示
                console.log("延迟1.5秒后显示游戏结束界面");
                showGameOverCountdown(1.5, condition);
                
                setTimeout(function() {
                    // 使用简化版的游戏结束函数
                    window.testGameOver(condition);
                }, 1500);
                
                return true;
            }
            return false;
        }

        // 添加一个可靠的强制指标闪烁函数（简化版）
        window.forceValueBlink = function(condition) {
            console.log("强制指标闪烁:", condition);
            
            // 停止所有现有的闪烁
            if (window.blinkIntervalId) {
                clearInterval(window.blinkIntervalId);
                window.blinkIntervalId = null;
            }
            
            let targetElement = null;
            let originalText = '';
            let zeroValueColor = '';
            
            // 确定目标元素
            if (condition === 'wealth') {
                targetElement = document.getElementById('wealth-value');
                originalText = '0';
                zeroValueColor = "#FFD700"; // 财富为金黄色
            } else if (condition === 'ph') {
                targetElement = document.getElementById('ph-value');
                originalText = '0/100';
                zeroValueColor = "#9C27B0"; // 体力为紫色
            } else if (condition === 'mh') {
                targetElement = document.getElementById('mh-value');
                originalText = '0/100';
                zeroValueColor = "#F44336"; // 精神为红色
            }
            
            // 如果找到目标元素
            if (targetElement) {
                console.log("找到目标元素:", targetElement.id);
                
                // 清除之前设置的样式
                let blinkBackground = document.getElementById('blink-background-' + condition);
                if (blinkBackground) {
                    blinkBackground.remove();
                }
                
                // 设置元素样式
                targetElement.style.transition = 'all 0.15s ease'; // 更快的过渡效果
                targetElement.style.display = 'inline-block'; // 确保可以应用变换
                targetElement.style.color = zeroValueColor;
                targetElement.style.fontWeight = 'bold';
                targetElement.style.fontSize = '110%'; // 略微放大
                targetElement.style.textShadow = `0 0 10px ${zeroValueColor}`;
                targetElement.textContent = originalText;
                
                // 使用setInterval进行更明显的跳动闪烁效果
                let isUp = true;
                let count = 0;
                window.blinkIntervalId = setInterval(function() {
                    count++;
                    
                    if (isUp) {
                        // 上跳动画
                        targetElement.style.transform = 'scale(1.3) translateY(-3px)';
                        targetElement.style.opacity = '1';
                        targetElement.style.textShadow = `0 0 15px ${zeroValueColor}`;
                    } else {
                        // 下跳动画
                        targetElement.style.transform = 'scale(0.9) translateY(2px)';
                        targetElement.style.opacity = '0.7';
                        targetElement.style.textShadow = 'none';
                    }
                    
                    // 每5次做一个特殊的大跳动
                    if (count % 5 === 0) {
                        targetElement.style.transform = 'scale(1.5) translateY(-5px)';
                        setTimeout(() => {
                            if (window.blinkIntervalId) { // 确保定时器仍然存在
                                targetElement.style.transform = 'scale(0.8) translateY(3px)';
                            }
                        }, 150);
                    }
                    
                    isUp = !isUp;
                }, 200); // 更快的闪烁频率
                
                console.log("启动新的闪烁定时器:", window.blinkIntervalId);
            } else {
                console.error("未找到指定条件的元素:", condition);
            }
        };

        // 添加testGameOver的全局版本
        window.testGameOver = testGameOver;

        // 添加测试函数用于直接测试credits页面
        function testCredits() {
            console.log("测试credits页面");
            
            // 获取event-container
            let eventContainer = document.querySelector('.event-container');
            if (!eventContainer) {
                // 如果没有event-container，创建一个
                const eventScreen = document.getElementById('event-screen');
                if (!eventScreen) {
                    // 如果没有event-screen，创建一个
                    const tempScreen = document.createElement('div');
                    tempScreen.id = 'event-screen';
                    tempScreen.classList.add('visible');
                    tempScreen.style.cssText = 'position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;';
                    
                    const tempContainer = document.createElement('div');
                    tempContainer.className = 'event-container';
                    tempScreen.appendChild(tempContainer);
                    
                    document.body.appendChild(tempScreen);
                    eventContainer = tempContainer;
                } else {
                    eventScreen.classList.add('visible');
                    eventContainer = eventScreen.querySelector('.event-container');
                    if (!eventContainer) {
                        const tempContainer = document.createElement('div');
                        tempContainer.className = 'event-container';
                        eventScreen.appendChild(tempContainer);
                        eventContainer = tempContainer;
                    }
                }
            }
            
            // 调用showCredits函数显示credits页面
            showCredits();
        }
        
        // 将testCredits函数暴露到全局作用域
        window.testCredits = testCredits;
    </script>
</body>
</html>